<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MLE 2023 - 8&nbsp; Ordinal Outcomes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./09-NominalOutcomes.html" rel="next">
<link href="./07-QuantitiesofInterest.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./08-OrdinalandOutcomes.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Ordinal Outcomes</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MLE 2023</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Maxmimum Likelihood Fall 2023</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-ROverview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">R Overview</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-TheMATH.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Math</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-ReviewofOLS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Review of OLS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-IntrotoMaximumLikelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to MLE</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-BinaryOutcomes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Binary Dependent Variables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-QuantitiesofInterest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Quantities of Interest</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-OrdinalandOutcomes.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Ordinal Outcomes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-NominalOutcomes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Multinomial Outcomes</span></span></a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Section Contents</h2>
   
  <ul>
  <li><a href="#ordinal-outcome-data" id="toc-ordinal-outcome-data" class="nav-link active" data-scroll-target="#ordinal-outcome-data"><span class="header-section-number">8.1</span> Ordinal Outcome Data</a>
  <ul>
  <li><a href="#ordinal-model" id="toc-ordinal-model" class="nav-link" data-scroll-target="#ordinal-model"><span class="header-section-number">8.1.1</span> Ordinal Model</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation"><span class="header-section-number">8.1.2</span> Interpretation</a></li>
  </ul></li>
  <li><a href="#likelihood-framework" id="toc-likelihood-framework" class="nav-link" data-scroll-target="#likelihood-framework"><span class="header-section-number">8.2</span> Likelihood Framework</a>
  <ul>
  <li><a href="#likelihood" id="toc-likelihood" class="nav-link" data-scroll-target="#likelihood"><span class="header-section-number">8.2.1</span> Likelihood</a></li>
  </ul></li>
  <li><a href="#fitting-ordinal-models-in-r" id="toc-fitting-ordinal-models-in-r" class="nav-link" data-scroll-target="#fitting-ordinal-models-in-r"><span class="header-section-number">8.3</span> Fitting Ordinal Models in R</a>
  <ul>
  <li><a href="#quantities-of-interest" id="toc-quantities-of-interest" class="nav-link" data-scroll-target="#quantities-of-interest"><span class="header-section-number">8.3.1</span> Quantities of Interest</a></li>
  </ul></li>
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions"><span class="header-section-number">8.4</span> Assumptions</a></li>
  <li><a href="#ordinal-practice-problems" id="toc-ordinal-practice-problems" class="nav-link" data-scroll-target="#ordinal-practice-problems"><span class="header-section-number">8.5</span> Ordinal Practice Problems</a>
  <ul>
  <li><a href="#a-note-on-robust-standard-errors" id="toc-a-note-on-robust-standard-errors" class="nav-link" data-scroll-target="#a-note-on-robust-standard-errors"><span class="header-section-number">8.5.1</span> A note on robust standard errors</a></li>
  </ul></li>
  <li><a href="#ordinal-tutorial" id="toc-ordinal-tutorial" class="nav-link" data-scroll-target="#ordinal-tutorial"><span class="header-section-number">8.6</span> Ordinal Tutorial</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="ordinal" class="quarto-section-identifier"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Ordinal Outcomes</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This section will cover ordinal logit and probit regression. These are models that work well for outcome variables that include a set of (more than 2) ordered discrete categories.</p>
<p>Often, survey responses have this form of outcome (e.g., a likert scale from “strongly agree” to “strongly disagree”). We also might categorize behavioral responses in an ordinal way from “stay home” to “protest”, for example.</p>
<p>You can review the following for additional external resources on this section.</p>
<ul>
<li>King, Gary. 1998. <em>Unifying political methodology: The likelihood theory of statistical inference</em>. University of Michigan Press. Chapter 5.4.</li>
<li>Resources for ordinal models in R <a href="http://r-statistics.co/Ordinal-Logistic-Regression-With-R.html">here</a> and <a href="https://stats.idre.ucla.edu/r/dae/ordinal-logistic-regression/">here</a></li>
<li>A section from Gelman and Hill Chapter 6, posted to Canvas.</li>
</ul>
<section id="ordinal-outcome-data" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="ordinal-outcome-data"><span class="header-section-number">8.1</span> Ordinal Outcome Data</h2>
<p>Here is a motivating example for the use of ordered data from Paluck and Green “Deference, Dissent, and Dispute Resolution: An Experimental Intervention Using Mass Media to Change Norms and Behavior in Rwanda” which was published in the <em>American Political Science Review</em> in 2009. doi:10.1017/S0003055409990128</p>
<p><em>Abstract. Deference and dissent strike a delicate balance in any polity. Insufficient deference to authority may incapacitate government, whereas too much may allow leaders to orchestrate mass violence. Although cross-national and cross-temporal variation in deference to authority and willingness to express dissent has long been studied in political science, rarely have scholars studied programs designed to change these aspects of political culture. This study, situated in post-genocide Rwanda, reports a qualitative and quantitative assessment of one such attempt, a radio program aimed at discouraging blind obedience and reliance on direction from authorities and promoting independent thought and collective action in problem solving. Over the course of one year, this radio program or a comparable program dealing with HIV was randomly presented to pairs of communities, including communities of genocide survivors, Twa people, and imprisoned genocidaires … Although the radio program had little effect on many kinds of beliefs and attitudes, it had a substantial impact on listeners’ willingness to express dissent and the ways they resolved communal problems.</em></p>
<p>In a field experiment, the authors have randomly assigned participants in different research sites to listen to a radio program over the course of a year that varied in its message. As the authors note, “Because radios and batteries are relatively expensive for Rwandans, they usually listen to the radio in groups. Thus, we used a group-randomized design in which adults from a community listened together either to the treatment (reconciliation) program or to the control program (another entertainment-education radio soap opera about health and HIV).” The authors have 14 clusters without 40 individuals within each cluster.</p>
<ul>
<li>Treatment (<code>treat</code>): radio program with one of two messages, where 1=the treatment condition with a reconciliation message and 0=control, listening to a health message.</li>
<li>Outcome (<code>dissent</code>): Willingness to Display Dissent: An ordered scale with four categories from 1 (“I should stay quiet”) to 4 (“I should dissent”)</li>
</ul>
<p>Let’s load the data and look at the treatment and outcome.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rio)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pg <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"https://github.com/ktmccabe/teachingdata/blob/main/paluckgreen.dta?raw=true"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Let's treat the outcome as a factor</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>pg<span class="sc">$</span>dissent <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pg<span class="sc">$</span>dissent)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Let's visualize the outcome by group</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>pg <span class="sc">%&gt;%</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(dissent)<span class="sc">==</span>F) <span class="sc">%&gt;%</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>dissent, <span class="at">group=</span><span class="fu">factor</span>(treat), </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="fu">factor</span>(treat)))<span class="sc">+</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y=</span>..prop..),<span class="at">stat=</span> <span class="st">"count"</span>, <span class="at">position=</span><span class="st">"dodge"</span>, <span class="at">color=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)<span class="sc">+</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="st">"Condition"</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Treatment"</span>),<span class="at">palette=</span><span class="st">"Paired"</span>)<span class="sc">+</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"Should Stay Quiet"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"Should Dissent"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="08-OrdinalandOutcomes_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see variation in the outcome, where some people are at the “stay quiet” end of the scale, while others are at the opposite end. We might have a few questions about the outcome:</p>
<ul>
<li>What is the probability of being in a particular category given a set of <span class="math inline">\(\mathbf{x_i'}\)</span> values?</li>
<li>Does the treatment influence likelihood of expressing dissent?</li>
<li>Does the treatment significantly affect the probability of responding in a particular category?</li>
</ul>
<p><strong>What model should they use to help answer these questions?</strong></p>
<p>One approach would be to use OLS.</p>
<ul>
<li>They could treat 1 to 4 scale as continuous from Should stay quiet to Should dissent</li>
<li>If they do this, the interpretation of the regression coefficients would be:
<ul>
<li>Going from Control to Treatment (0 to 1), is associated with <span class="math inline">\(\hat \beta\)</span> movement on this scale.</li>
</ul></li>
<li>What could be problematic here?
<ul>
<li>Might go below or above scale points</li>
<li>Distance between scale points might not be an equal interval</li>
<li>Doesn’t answer the “probability” question, just describes movement up and down the scale.</li>
</ul></li>
</ul>
<p>A second approach could be to collapse the scale to be dichotomous and use logit/probit or a linear probability model.</p>
<ul>
<li>For example, they could treat the outcome to 0 = (lean toward stay quiet/stay quiet) vs.&nbsp;1 (lean toward dissent/dissent)</li>
<li>Here, after converting the outcomes in probability, the interpretation would be
<ul>
<li>Going from Control to Treatment (0 to 1), is associated with an average difference in predicted probability of dissent (<span class="math inline">\(Y_i = 1\)</span>)</li>
</ul></li>
<li>What could be problematic here?
<ul>
<li>We lose information.</li>
</ul></li>
</ul>
<p>A third approach–and the focus of this section– would be to use an ordinal logistic or probit regression.</p>
<ul>
<li>This is appropriate when our goal, at least in part, is to estimate the probability of being in a specific category, and these categories have a natural ordering to them.</li>
</ul>
<section id="ordinal-model" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="ordinal-model"><span class="header-section-number">8.1.1</span> Ordinal Model</h3>
<p>With ordered data, we have an outcome variable <span class="math inline">\(Y_i\)</span> that can fall into different, ordered categories: <span class="math inline">\(Y_i \in \{C_1, C_2, \ldots, C_J \}\)</span> with some probability.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="08-OrdinalandOutcomes_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>The image above shows a distribution where the area under the curve sums to 1, with the area divided into 4 categories, separated by three cutpoints. The area represents probability mass. For example, the area to the left of z1 represents the</em> <span class="math inline">\(Pr(Y_i^\ast \leq z1)\)</span>.</p>
<p>In our ordered model, we assume that there is a latent (unobserved) <span class="math inline">\(Y^\ast_i = X_i\beta + \epsilon\)</span></p>
<ul>
<li>This means we can still have a single model <span class="math inline">\(X_i \beta\)</span>, which determines what outcome level is achieved (this requires an assumption).</li>
<li>where <span class="math inline">\(\epsilon\)</span> is either assumed to be normally distributed (probit) or distributed logistically (logit), and corresponds to the fuzziness of the cutpoints (<span class="math inline">\(\zeta_j\)</span>), which define in which category an outcome is observed to fall. Instead of <a href="https://www.youtube.com/watch?v=Ojp71GGm-LQ">fine lines</a>, we estimate probabilistically in which category <span class="math inline">\(Y_i\)</span> is predicted to fall.</li>
</ul>
<p>We observe this category in our outcome: <span class="math inline">\(Y_i\)</span>.</p>
<ul>
<li>For example, we observe if someone said “should stay quiet” or “should dissent” vs.&nbsp;one of the two middle categories.</li>
</ul>
<span class="math display">\[\begin{gather*}
Y_i=\begin{cases}
C_1 \textrm{ if } Y^\ast_i  \le \zeta_1\\
C_2 \textrm{ if } \zeta_1 &lt; Y^\ast_i  \le \zeta_2\\
C_3 \textrm{ if } \zeta_2 &lt;  Y^\ast_i  \le \zeta_3\\
\ldots\\
C_J\textrm{ if } \zeta_{J-1} &lt; Y^\ast_i \\
\end{cases}\\
\end{gather*}\]</span>
<p>The <span class="math inline">\(\zeta_j\)</span> are called “cutpoints”</p>
<ul>
<li>Need cutpoints that are distinct, but the distance between cutpoints does not have to be the same.
<ul>
<li>This can be particularly useful when we have scales that have a natural ordering, but the distance between scale points might not have the same meaning or be the same (e.g., “Agree”,“Disagree”, “Revolt”). This is different from an interval variable, where we assume the difference between scale points carries the same meaning (e.g., credit score, cups of flour in a recipe).</li>
</ul></li>
<li>Note: There is no intercept in linear prediction model in this case. Instead of the intercept, we have the specific cutpoints.</li>
<li>Rule of thumb: Estimation with more than 3-5 categories unstable</li>
</ul>
</section>
<section id="interpretation" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="interpretation"><span class="header-section-number">8.1.2</span> Interpretation</h3>
<p>Here is an example of what the ordered probit model output can look like from the authors’ paper. You can see coefficients similar to the models we’ve been working with before but instead of an intercept, we have the different cutpoints, in this case, three cutpoints for <span class="math inline">\(J-1\)</span> categories.</p>
<p><img src="images/rawandaresults.png" class="img-fluid"></p>
<p>We can interpret the coefficients as a one-unit increase in <span class="math inline">\(x\)</span> has a <span class="math inline">\(\hat \beta\)</span> increase/decrease in the linear predictor scale of <span class="math inline">\(Y^\ast\)</span> (in log-odds for logit or probit z-score standard deviations).</p>
<ul>
<li>This gives us an initial sense (based on sign and significance) of how an independent variable positively or negatively affects the position of <span class="math inline">\(Y*\)</span>. However, it does not give us any information about specific categories.</li>
<li>Thus, alas, this is unsatisfying for a couple of reasons.
<ul>
<li><span class="math inline">\(Y_i^\ast\)</span> is an unobserved variable (not the categories themselves)</li>
<li>The scale is harder to interpret than probability</li>
</ul></li>
<li>Therefore, we will generally want to convert our estimates into probabilities (our quantities of interest)
<ul>
<li>One wrinkle here is we now have <span class="math inline">\(J\)</span> predicted probabilities to estimate, one for each category.</li>
<li>A second wrinkle here is any change in the probability of being in the <span class="math inline">\(jth\)</span> category of <span class="math inline">\(Y\)</span> also affects the probabilities of being in the <span class="math inline">\(\neq jth\)</span> categories because the probabilities of being in each category have to sum together to 1. (E.g., Increasing the probability that someone said “should dissent” affects the probability they said “should stay quiet.)</li>
</ul></li>
</ul>
</section>
</section>
<section id="likelihood-framework" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="likelihood-framework"><span class="header-section-number">8.2</span> Likelihood Framework</h2>
<p>In the binary case, we wanted to estimate <span class="math inline">\(Pr(Y_i = 1 | X)\)</span>. Our goal in an ordinal model is to estimate the probability that <span class="math inline">\(Y_i\)</span> is in a particular <span class="math inline">\(j\)</span> category <span class="math inline">\(C_j\)</span>.</p>
<p><span class="math inline">\(Pr(Y_i = C_j | X)\)</span></p>
<p>To do so, we are going to use the cumulative distribution functions to estimate the probability that <span class="math inline">\(Y_i\)</span> is below a particular cutpoint <span class="math inline">\(\zeta_j\)</span> or between two cutpoints <span class="math inline">\(\zeta_j\)</span> and <span class="math inline">\(\zeta_{j+1}\)</span>.</p>
<p>Finding predicted probabilities for a given <span class="math inline">\(j\)</span> category can be written as follows: <span class="math inline">\(Pr(Y_i|X_i) = \mathbf 1(Y_i=C_j) \{ \Pr(Y^\ast \le \zeta_{j})- \Pr(Y^\ast \le \zeta_{j-1})\}\)</span></p>
<p>We can spell this out more explicitly for each <span class="math inline">\(j\)</span> category:</p>
<ul>
<li><span class="math inline">\(Pr(Y_i = C_{J} | X) = 1 - Pr(Y^\ast\leq \zeta_{J - 1} | X_i)\)</span></li>
<li><span class="math inline">\(Pr(Y_i = C_{3} | X) = Pr(Y^\ast \leq \zeta_{3} | X_i) - Pr(Y^\ast \leq \zeta_{2} | X_i)\)</span></li>
<li><span class="math inline">\(Pr(Y_i = C_{2} | X) = Pr(Y^\ast \leq \zeta_{2} | X_i) - Pr(Y^\ast \leq \zeta_{1} | X_i)\)</span></li>
<li><span class="math inline">\(Pr(Y_i = C_{1} | X) = Pr(Y^\ast \leq \zeta_{1} | X_i)\)</span></li>
</ul>
<p>Just as in the binary case, we use our <span class="math inline">\(\Phi()\)</span> <code>pnorm</code> or <span class="math inline">\(\frac{exp^{X\beta}}{1 + exp^{X\beta}}\)</span> <code>plogis</code> functions to get our probabilities from the linear predictors. However, in this ordered case, we also have to include the estimate for the cutpoint <span class="math inline">\(\zeta_j\)</span> when performing this operation. You can kind of think of this as having a separate intercept for each category instead of just one intercept in the binary case.</p>
<p>For example, in the ordinal logit case, the linear predictor is in the scale of log of the proportional-odds. We can write our regression as:</p>
<p><span class="math inline">\(\log \frac{P(Y \leq j | X)}{P(Y &gt; j | X)} = (\zeta_j - \eta)\)</span> where <span class="math inline">\(\eta = x_1\beta_1 + x_2\beta_2 + ... + x_k\beta_k\)</span></p>
<ul>
<li>To get probability we apply the <code>plogis</code> function <span class="math inline">\(logit^{-1}(\zeta_j - \eta)\)</span></li>
<li>Same for probit, but we use <code>pnorm</code>: <span class="math inline">\(probit^{-1}(\zeta_j - \eta)\)</span></li>
</ul>
<section id="likelihood" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="likelihood"><span class="header-section-number">8.2.1</span> Likelihood</h3>
<p>The likelihood of all observations, assuming independence is:</p>
<p><span class="math inline">\(\mathcal L(\beta, \zeta | Y) = \prod_{i=1}^{N} Pr(Y_i = C_j)\)</span> for a given category. To incorporate all <span class="math inline">\(J\)</span> categories, we can write:</p>
<p><span class="math inline">\(\mathcal L(\beta, \zeta | Y) = \prod_{i=1}^{N} \prod_{j=1}^{J} \mathbf 1(Y_i=C_j) \{ \Pr(Y^\ast \le \zeta_{j}) - \Pr(Y^\ast \le \zeta_{j-1})\}\)</span> where <span class="math inline">\(\mathbf 1(Y_i=C_j)\)</span> is an indicator for whether or not a given <span class="math inline">\(Y_i\)</span> is observed in the <span class="math inline">\(jth\)</span> category.</p>
<p>Note that here instead of estimating just <span class="math inline">\(\beta\)</span>, we now also estimate the cutpoints <span class="math inline">\(\zeta\)</span>.</p>
<p>The log likelihood then just changes this to the sum:</p>
<span class="math display">\[\begin{align*}
\mathcal l(\beta, \zeta | Y) &amp;= \sum_{i=1}^{N} \sum_{j=1}^{J}\mathbf 1(Y_i=C_j) \{  \log( \Pr(Y^\ast  \le \zeta_{j}) - \Pr(Y^\ast  \le \zeta_{j-1}))\}\\
&amp;= \sum_{i=1}^{N} \sum_{j=1}^{J} \mathbf 1(Y_i=C_j) \{\log(\Phi(\zeta_j - \mathbf x_i'\beta) - \Phi(\zeta_{j-1} - \mathbf x_i'\beta))\}
\end{align*}\]</span>
<p>In addition to assuming independence of our observations, we assume each category has a nonzero probability of being observed and that the cutpoints are monotonically increasing: <span class="math inline">\(\zeta_j &lt; \zeta_{j+1}\)</span>.</p>
</section>
</section>
<section id="fitting-ordinal-models-in-r" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="fitting-ordinal-models-in-r"><span class="header-section-number">8.3</span> Fitting Ordinal Models in R</h2>
<p>To fit an ordinal logit or probit model in R, we can use the <code>MASS</code> package and <code>polr</code> function.</p>
<p>You may need to install this in your RStudio the first time you use it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"MASS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When we are ready to run the model, we then open the package and use the function <code>polr</code>. The first inputs are very similar to <code>lm</code> and <code>glm</code>. However, we add an argument specifying the <code>method =</code> which can be “logistic” (the default) or “probit.” We also specify <code>Hess=T</code> to make sure we get the uncertainty estimates with the results.</p>
<ul>
<li>By the way, why would that argument be called <code>Hess</code>?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">polr</span>(<span class="fu">as.factor</span>(dissent) <span class="sc">~</span> treat, <span class="at">data=</span> pg, <span class="at">Hess =</span> T, <span class="at">method =</span> <span class="st">"probit"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
polr(formula = as.factor(dissent) ~ treat, data = pg, Hess = T, 
    method = "probit")

Coefficients:
       Value Std. Error t value
treat 0.2645     0.1021   2.589

Intercepts:
    Value   Std. Error t value
1|2 -0.5102  0.0761    -6.7017
2|3 -0.0576  0.0740    -0.7784
3|4  0.2697  0.0742     3.6344

Residual Deviance: 1253.844 
AIC: 1261.844 
(116 observations deleted due to missingness)</code></pre>
</div>
</div>
<p>To get p-values, we can use the <code>AER</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
z test of coefficients:

       Estimate Std. Error z value  Pr(&gt;|z|)    
treat  0.264455   0.102143  2.5891 0.0096238 ** 
1|2   -0.510237   0.076135 -6.7017  2.06e-11 ***
2|3   -0.057570   0.073958 -0.7784 0.4363235    
3|4    0.269665   0.074198  3.6344 0.0002786 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Or calculate manually</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="fu">abs</span>(<span class="fu">summary</span>(fit)<span class="sc">$</span>coefficients[,<span class="dv">3</span>]), </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">lower.tail =</span> F), <span class="at">digits=</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   treat      1|2      2|3      3|4 
0.009624 0.000000 0.436323 0.000279 </code></pre>
</div>
</div>
<details>
<summary>
For details on how to fit this manually in R using <code>optim</code>, expand.
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grab X and Y, listwise deletion</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>pgsub <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(<span class="fu">cbind</span>(pg<span class="sc">$</span>dissent, pg<span class="sc">$</span>treat))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> pgsub[,<span class="dv">1</span>]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> pgsub[, <span class="dv">2</span>]</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Log likelihood in R for this example</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>llikor <span class="ot">&lt;-</span> <span class="cf">function</span>(par, Y, X){</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># X columns</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># categories</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> par[<span class="dv">1</span><span class="sc">:</span>k]</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  zeta <span class="ot">&lt;-</span> par[(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(par)]</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span><span class="fu">cbind</span>(X)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> <span class="fu">cbind</span>(beta)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="do">## linear predictor</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  eta <span class="ot">&lt;-</span> X <span class="sc">%*%</span> beta</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="do">## indicator variables</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Y<span class="sc">==</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  y2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Y<span class="sc">==</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  y3 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Y<span class="sc">==</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  y4 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Y<span class="sc">==</span><span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="do">## likelihood for each category</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  l1 <span class="ot">&lt;-</span> y1<span class="sc">*</span><span class="fu">log</span>(<span class="fu">pnorm</span>(zeta[<span class="dv">1</span>] <span class="sc">-</span> eta))</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  l2 <span class="ot">&lt;-</span> y2<span class="sc">*</span><span class="fu">log</span>(<span class="fu">pnorm</span>(zeta[<span class="dv">2</span>] <span class="sc">-</span> eta) <span class="sc">-</span> <span class="fu">pnorm</span>(zeta[<span class="dv">1</span>] <span class="sc">-</span> eta)) </span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  l3 <span class="ot">&lt;-</span> y3<span class="sc">*</span><span class="fu">log</span>(<span class="fu">pnorm</span>(zeta[<span class="dv">3</span>] <span class="sc">-</span> eta) <span class="sc">-</span> <span class="fu">pnorm</span>(zeta[<span class="dv">2</span>] <span class="sc">-</span> eta)) </span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  l4 <span class="ot">&lt;-</span> y4<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(zeta[<span class="dv">3</span>] <span class="sc">-</span> eta))</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="do">## sum together</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  llik <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">c</span>(l1, l2, l3, l4))</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(llik)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Optimize</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>opt.out <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(.<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">fn=</span>llikor, <span class="at">X=</span>X, <span class="at">Y=</span>Y, <span class="at">method=</span><span class="st">"BFGS"</span>,</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">control=</span><span class="fu">list</span>(<span class="at">fnscale=</span><span class="sc">-</span><span class="dv">1</span>), <span class="at">hessian =</span> T)</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>opt.out<span class="sc">$</span>par[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2644911</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    treat 
0.2644546 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Cutpoints</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>opt.out<span class="sc">$</span>par[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.51019872 -0.05757855  0.26969063</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fit<span class="sc">$</span>zeta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1|2        2|3        3|4 
-0.5102370 -0.0575699  0.2696646 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Standard errors</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(<span class="sc">-</span> opt.out<span class="sc">$</span>hessian)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.10214310 0.07613473 0.07395763 0.07419776</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(fit)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     treat        1|2        2|3        3|4 
0.10214309 0.07613503 0.07395770 0.07419775 </code></pre>
</div>
</div>
</details>
<section id="quantities-of-interest" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="quantities-of-interest"><span class="header-section-number">8.3.1</span> Quantities of Interest</h3>
<p>In discussing the results of Table 3 from the ordered probit analysis in the paper, the authors note, “A shift of .26 probits implies, for example, that a health group respondent with a 30% chance of strongly agreeing to dissent would move to a 40% chance if assigned to the reconciliation program group. This is a large, but not implausibly large, shift in opinion.”</p>
<p>Similar to the binary case, we can convert our estimates to probability, but here we will do it for specific categories. Let’s first conduct an estimate of the difference in probability of being in the top category of dissent for those in the treatment - control conditions.</p>
<p>We will follow the formulas outlined above. For the top category (category 4 here) we have:</p>
<ul>
<li><span class="math inline">\(Pr(Y_i = C_4) = 1 - Pr(Y^* \leq \zeta_{4-1} | X_i)\)</span> where our estimate of <span class="math inline">\(Y* = X\hat \beta\)</span>.</li>
</ul>
<p>To calculate this we take <span class="math inline">\(1 -\)</span> <code>pnorm</code><span class="math inline">\((\zeta_{4-1} - X\hat \beta)\)</span></p>
<ul>
<li>Note that we use <code>pnorm</code> because this is a probit model. If it were a logistic model, we would use <code>plogis</code> instead.</li>
<li>We are estimating the probability that our observation is in category 4, when setting <span class="math inline">\(X\)</span> to particular values. In this case, we will estimate the probability when an observation is in the treatment or control group.</li>
</ul>
<p>Let’s find <span class="math inline">\(X\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(fit)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept) treat
1           1     0
2           1     0
3           1     0
4           1     0
5           1     0
6           1     0</code></pre>
</div>
</div>
<p>Let’s estimate the probability when someone is in the treatment group vs.&nbsp;control group. For this, we will set X to be 1 or 0. Because we only have one coefficient in our model, we actually don’t need the entire matrix. For example, once we set <code>treat</code> to be 1, all observations (rows) are identical to each other:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>X[, <span class="st">"treat"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># in treatment</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept) treat
1           1     1
2           1     1
3           1     1
4           1     1
5           1     1
6           1     1</code></pre>
</div>
</div>
<p>So instead of estimating the outcome for every single row and then take the mean, we could just estimate the outcome for one row given that all rows are identical. In regressions where you have other covariates, those covariates will likely have different values, making the rows distinct. This is a special case where the below code would give identical results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Xt <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>,<span class="dv">1</span>) <span class="co"># A 1 for the intercept and 1 for the treatment</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>Xc <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>,<span class="dv">0</span>) <span class="co"># A 1 for the intercept and 0 for the treatment (being in the control)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>By default, R will include an Intercept in the <code>model.matrix</code>. We actually do not want this when calculating ordinal regression quantities of interest because the cutpoints will be serving the purpose of the intercept. So we will remove this from <span class="math inline">\(X\)</span>, but we will use <code>as.matrix()</code> to make sure R will still treat the object like a matrix.</p>
<ul>
<li>If you instead used the full <span class="math inline">\(X\)</span> matrix, the only extra step you would need to do is to take the <code>mean()</code> of the probability estimates below (e.g., the mean of <code>pp1.4</code>). See the practice problem solution in 8.5 for an example.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [,1]
1    1
2    1
3    1
4    1
5    1
6    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>Xt <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(Xt[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>Xt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>Xc <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(Xc[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>Xc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]    0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">## probability of being in top category</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>cutpoint3 <span class="ot">&lt;-</span> fit<span class="sc">$</span>zeta[<span class="dv">3</span>] <span class="co"># grab the top cutpoint J - 1, 4-1=3</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit) <span class="co"># coefficients</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>pp1<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(cutpoint3 <span class="sc">-</span> Xt<span class="sc">%*%</span>b) <span class="co"># prob of top category for treatment</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>pp1<span class="fl">.4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 0.4979215</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>pp0<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(cutpoint3 <span class="sc">-</span> Xc<span class="sc">%*%</span>b) <span class="co"># prob of top category for control</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>pp0<span class="fl">.4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 0.3937091</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="do">## difference</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>pp1<span class="fl">.4</span> <span class="sc">-</span> pp0<span class="fl">.4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 0.1042124</code></pre>
</div>
</div>
<p>We recover that there is an 10 percentage point difference in probability of being in the top category of dissent, predicted for those in the treatment vs.&nbsp;control.</p>
<p>If we were interested in other categories, we could similarly compare probabilities within those. For example, what about category 3?</p>
<ul>
<li>Here we just apply a different formula from 8.2: <span class="math inline">\(Pr(Y_i = C_3) = Pr(Y^* \leq \zeta_{3} | X_i) - Pr(Y^* \leq \zeta_{2} | X_i)\)</span> where our estimate of <span class="math inline">\(Y^* = X\hat \beta\)</span>.</li>
</ul>
<p>To calculate this we take <code>pnorm</code><span class="math inline">\((\zeta_{3} - X\hat \beta)\)</span> - <code>pnorm</code><span class="math inline">\((\zeta_{2} - X\hat \beta)\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>cutpoint3 <span class="ot">&lt;-</span> fit<span class="sc">$</span>zeta[<span class="dv">3</span>]</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>cutpoint2 <span class="ot">&lt;-</span> fit<span class="sc">$</span>zeta[<span class="dv">2</span>]</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>pp1<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(cutpoint3 <span class="sc">-</span> Xt<span class="sc">%*%</span>b) <span class="sc">-</span> <span class="fu">pnorm</span>(cutpoint2 <span class="sc">-</span> Xt<span class="sc">%*%</span>b)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>pp1<span class="fl">.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 0.1283614</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>pp0<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(cutpoint3 <span class="sc">-</span> Xc<span class="sc">%*%</span>b) <span class="sc">-</span> <span class="fu">pnorm</span>(cutpoint2 <span class="sc">-</span> Xc<span class="sc">%*%</span>b)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>pp0<span class="fl">.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 0.1292452</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>pp1<span class="fl">.3</span> <span class="sc">-</span> pp0<span class="fl">.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             [,1]
[1,] -0.000883825</code></pre>
</div>
</div>
<p>These represent the estimated probabilities of being in category 3, or the estimated difference in probability of being in category 3 for the treatment vs.&nbsp;control condition.</p>
<p>What about category 2 or category 1?</p>
<details>
<summary>
Try on your own, and then expand for the solution.
</summary>
<ul>
<li>Category 2: Here we just apply a different formula from 8.2: <span class="math inline">\(Pr(Y_i = C_2) = Pr(Y^* \leq \zeta_{2} | X_i) - Pr(Y^* \leq \zeta_{1} | X_i)\)</span>.</li>
<li>Category 1: Here we just apply a different formula from 8.2: <span class="math inline">\(Pr(Y_i = C_1) = Pr(Y^* \leq \zeta_{1} | X_i)\)</span>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>cutpoint1 <span class="ot">&lt;-</span> fit<span class="sc">$</span>zeta[<span class="dv">1</span>]</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>cutpoint2 <span class="ot">&lt;-</span> fit<span class="sc">$</span>zeta[<span class="dv">2</span>]</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="do">## category 2</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>pp1<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(cutpoint2 <span class="sc">-</span> Xt<span class="sc">%*%</span>b) <span class="sc">-</span> <span class="fu">pnorm</span>(cutpoint1 <span class="sc">-</span> Xt<span class="sc">%*%</span>b)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>pp1<span class="fl">.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 0.1544561</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>pp0<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(cutpoint2 <span class="sc">-</span> Xc<span class="sc">%*%</span>b) <span class="sc">-</span> <span class="fu">pnorm</span>(cutpoint1 <span class="sc">-</span> Xc<span class="sc">%*%</span>b)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>pp0<span class="fl">.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 0.1721029</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>pp1<span class="fl">.2</span> <span class="sc">-</span> pp0<span class="fl">.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]
[1,] -0.01764679</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">## category 1 (bottom category)</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>pp1<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(cutpoint1 <span class="sc">-</span> Xt<span class="sc">%*%</span>b)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>pp1<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 0.2192609</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>pp0<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(cutpoint1 <span class="sc">-</span> Xc<span class="sc">%*%</span>b) </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>pp0<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 0.3049427</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>pp1<span class="fl">.1</span> <span class="sc">-</span> pp0<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]
[1,] -0.08568175</code></pre>
</div>
</div>
</details>
<p>We can use our R shortcuts for all categories. Here, to make sure we are in probabilities, we can use <code>type="probs"</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="do">## predict</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>prs <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">treat =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>prs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1         2         3         4
1 0.3049427 0.1721029 0.1292452 0.3937091
2 0.2192609 0.1544561 0.1283614 0.4979215</code></pre>
</div>
</div>
<p>The first row shows the probability of being in each category (1 through 4) for the first entry for the treat variable (0), implying that the observation was in the control group. The second row does the same thing for when the treat variable is 1, implying that the observation was in the treatment group. These should match up with our manual calculations.</p>
<p>The <code>marginaleffects</code> and <code>prediction</code> packages will also work to some extent, which is nice when you have covariates you want to hold at observed values. Note that we put whatever the names of the levels of our variables are.</p>
<ul>
<li>It just so happens that in this case, both <code>treat</code> and our <code>dissent</code> outcomes have numbers for the categories. In other cases, you might have text as the category names, in which case you would enter those text values (e.g., “Somewhat Agree” or “Treatment condition”) as the variable or category labels.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="do">## marginaleffects</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="do">## predicts for all categories</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>outme <span class="ot">&lt;-</span> <span class="fu">predictions</span>(fit, <span class="at">newdata =</span>  <span class="fu">datagrid</span>(<span class="at">treat =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)))</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>outme</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Group treat Estimate Std. Error     z Pr(&gt;|z|)     S  2.5 % 97.5 %
     1     0    0.305     0.0267 11.44   &lt;0.001  98.2 0.2527  0.357
     1     1    0.219     0.0245  8.95   &lt;0.001  61.3 0.1713  0.267
     2     0    0.172     0.0176  9.79   &lt;0.001  72.8 0.1377  0.207
     2     1    0.154     0.0164  9.41   &lt;0.001  67.4 0.1223  0.187
     3     0    0.129     0.0151  8.56   &lt;0.001  56.3 0.0997  0.159
     3     1    0.128     0.0150  8.54   &lt;0.001  56.0 0.0989  0.158
     4     0    0.394     0.0285 13.79   &lt;0.001 141.4 0.3378  0.450
     4     1    0.498     0.0313 15.91   &lt;0.001 186.8 0.4366  0.559

Columns: rowid, group, estimate, std.error, statistic, p.value, s.value, conf.low, conf.high, dissent, treat 
Type:  probs </code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="do">## to filter for a specific category, like category 4:</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(outme, group<span class="sc">==</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Group Estimate Std. Error    z Pr(&gt;|z|)     S CI low CI high
     4    0.394     0.0285 13.8   &lt;0.001 141.4  0.338   0.450
     4    0.498     0.0313 15.9   &lt;0.001 186.8  0.437   0.559

Columns: rowid, group, estimate, std.error, statistic, p.value, s.value, conf.low, conf.high, dissent, treat </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Prediction</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(prediction)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="do">## can specify which category</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>outp <span class="ot">&lt;-</span> <span class="fu">prediction</span>(fit, <span class="at">at =</span> <span class="fu">list</span>(<span class="at">treat =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">category =</span> <span class="st">"4"</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(outp)<span class="sc">$</span>Prediction</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3937091 0.4979215</code></pre>
</div>
</div>
<p>If we wanted to compare treatment conditions to see the difference in probability, we would move to the <code>avg_comparisons</code> function in <code>marginaleffects</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>marg.me <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(fit, <span class="at">type=</span><span class="st">"probs"</span>,</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">variables =</span> <span class="fu">list</span>(<span class="at">treat =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)))</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(marg.me, group <span class="sc">==</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Group  Term Contrast  Estimate Std. Error      z Pr(&gt;|z|)   S   CI low CI high
     3 treat    1 - 0 -0.000884    0.00186 -0.475    0.635 0.7 -0.00453 0.00276

Columns: term, group, contrast, estimate, std.error, statistic, p.value, s.value, conf.low, conf.high </code></pre>
</div>
</div>
<p>Finally, the <code>margins</code> package should also work in many cases. You can compare this output with the <code>pp1.4 - pp0.4</code> calculation from above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margins)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>marg.obj <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">margins</span>(fit, <span class="at">variables =</span> <span class="st">"treat"</span>, <span class="at">change =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">vce=</span><span class="st">"bootstrap"</span>, <span class="at">category =</span> <span class="st">"4"</span>))</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>marg.obj</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> factor    AME     SE      z      p  lower  upper
  treat 0.1042 0.0395 2.6380 0.0083 0.0268 0.1816</code></pre>
</div>
</div>
<p>How can we visualize the results?</p>
<ul>
<li>Given our independent variable of interest, <code>treat</code> just has two categories, we could make a plot similar to the barplot at the beginning of the section.</li>
<li>When our independent variable of interest has several categories, things can get a bit messier. We will do an example in a weekly tutorial.</li>
</ul>
<p>How can we get uncertainty?</p>
<ul>
<li>Like before, we can use bootstrap or simulation, or ask <code>marginaleffects</code> or <code>margins</code> to do it for us.</li>
</ul>
<p>How can we incorporate covariates?</p>
<ul>
<li>Like before, we would just have a matrix of <span class="math inline">\(X\)</span> covariates instead of a single column for the treatment.</li>
<li>Like before, we could also calculate probabilities holding those covariates at observed values or setting them to designated values of interest.</li>
</ul>
<p>How could we fit a logit version?</p>
<ul>
<li>We just switch the <code>method = "logistic"</code>, and then we should be careful to also use <code>plogis()</code> in place of <code>pnorm</code> for the probability calculation.</li>
<li>Note: ordered logits also have the benefit of having the odds ratio interpretation when we <code>exp(coef(fit))</code> exponentiate the coefficients. See this <a href="https://stats.idre.ucla.edu/r/dae/ordinal-logistic-regression/">post</a>’s section on “Interpreting the odds ratio” halfway down the page for more information. Again, it is more common in political science to see probabilities than odds ratios, but different disciplines prefer different quantities of interest.</li>
</ul>
</section>
</section>
<section id="assumptions" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="assumptions"><span class="header-section-number">8.4</span> Assumptions</h2>
<p>A key assumption for the ordinal models is Parallel lines/Proportional Odds: We only have one set of <span class="math inline">\(k \times 1\)</span> <span class="math inline">\(\hat \beta\)</span>, not a separate set of coefficients for each ordinal category.</p>
<ul>
<li>This means that the relationship between the lowest versus all higher categories of the response variable are assumed to be the same as those that describe the relationship between the next lowest category and all higher categories, etc.
<ul>
<li>For each <span class="math inline">\(X\)</span> term included in the model, the coefficient ‘slopes’ are the same regardless of the threshold. If not, we would need a separate set of coefficients describing each pair of outcomes (e.g., Slopes for being in Cat 1 vs.&nbsp;Cat 2; Cat 2 vs.&nbsp;Cat 3, etc.)</li>
</ul></li>
<li>Even though we have different cutpoint values across categories, a one-unit change, going from control to treatment, the effects are parallel across response categories.</li>
<li>For example, if theoretically, being a woman vs.&nbsp;a man has a positive effect on moving between Categories 3 and 4 in a particular model, but you believe it would have the opposite effect for moving from Category 1 to 2, this would suggest the ordinal model is not appropriate.</li>
</ul>
<p>What to do if assumption is violated? Ignore, Do Binary, Do multinomial (discussed in the next session), use a model that has been developed for relaxing this assumption (e.g., see <code>clm</code> function in R).</p>
<p>One test for this that has been developed for the ordered logit case is the Brant test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>fit.l <span class="ot">&lt;-</span> <span class="fu">polr</span>(<span class="fu">as.factor</span>(dissent) <span class="sc">~</span> treat, <span class="at">data=</span> pg, </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">Hess =</span> T, <span class="at">method =</span> <span class="st">"probit"</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="do">## One way to test this</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("brant")</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brant)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="fu">brant</span>(fit.l,<span class="at">by.var=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-------------------------------------------- 
Test for    X2  df  probability 
-------------------------------------------- 
Omnibus     3.93    2   0.14
treat       3.93    2   0.14
-------------------------------------------- 

H0: Parallel Regression Assumption holds</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Second way- compare fit of ordinal and multinom models</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("nnet")</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>mlm <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="fu">as.factor</span>(dissent) <span class="sc">~</span> treat, <span class="at">data=</span>pg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  12 (6 variable)
initial  value 686.215709 
iter  10 value 625.130759
final  value 625.130585 
converged</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">logLik</span>(fit.l)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> <span class="fu">logLik</span>(mlm)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>G <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(M1[<span class="dv">1</span>] <span class="sc">-</span> M2[<span class="dv">1</span>])</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(G, <span class="dv">6</span> <span class="sc">-</span> <span class="dv">4</span>,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1667305</code></pre>
</div>
</div>
<p>In both cases, our p-value is large enough that we cannot reject the null hypothesis, meaning that we are “okay” sticking with the assumption in this case.</p>
</section>
<section id="ordinal-practice-problems" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="ordinal-practice-problems"><span class="header-section-number">8.5</span> Ordinal Practice Problems</h2>
<p>Here are a few practice problems for ordered models.</p>
<ol type="1">
<li>Try to replicate column 2 from Table 3 by adding <code>factor(site_pr)</code> to the regression model. Note that the standard errors will not exactly match. We will discuss why in a follow-up section.</li>
<li>Calculate the average predicted probability of leaning toward staying quiet (category 2) for the treatment and control group, holding covariates at observed values.
<ul>
<li>Note: If you do this manually, you need to remove the intercept column that is automatically added to the <code>model.matrix</code></li>
</ul></li>
</ol>
<details>
<summary>
Try on your own, and then expand for the solution.
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>fit.c2 <span class="ot">&lt;-</span> <span class="fu">polr</span>(<span class="fu">as.factor</span>(dissent) <span class="sc">~</span> treat <span class="sc">+</span> <span class="fu">factor</span>(site_pr), </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>pg, <span class="at">method=</span><span class="st">"probit"</span>, <span class="at">Hess =</span>T)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit.c2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           treat factor(site_pr)2 factor(site_pr)3 factor(site_pr)4 
      0.28484306      -0.17480464      -0.25513562      -0.17731799 
factor(site_pr)5 factor(site_pr)6 factor(site_pr)7 
     -0.30547159      -0.11384681       0.04659582 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Option 1a</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>p1me <span class="ot">&lt;-</span> <span class="fu">avg_predictions</span>(fit.c2, <span class="at">by =</span> <span class="st">"treat"</span>,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">newdata =</span> <span class="fu">datagridcf</span>(<span class="at">treat=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)))</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(p1me, group<span class="sc">==</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Group Estimate Std. Error    z Pr(&gt;|z|)    S CI low CI high
     2    0.173     0.0176 9.81   &lt;0.001 73.0  0.138   0.207
     2    0.154     0.0164 9.39   &lt;0.001 67.2  0.122   0.186

Columns: group, treat, estimate, std.error, statistic, p.value, s.value, conf.low, conf.high </code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Option 1b</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(prediction)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">prediction</span>(fit.c2, <span class="at">at=</span><span class="fu">list</span>(<span class="at">treat=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="at">category=</span><span class="dv">2</span>)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(p1)<span class="sc">$</span>Prediction</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1726136 0.1537839</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Option 2</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(fit.c2)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>X[, <span class="st">"treat"</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>bh <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit.c2)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span> X <span class="sc">%*%</span> bh</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>cutpoint2 <span class="ot">&lt;-</span> fit.c2<span class="sc">$</span>zeta[<span class="dv">2</span>]</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>cutpoint1 <span class="ot">&lt;-</span> fit.c2<span class="sc">$</span>zeta[<span class="dv">1</span>]</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">pnorm</span>(cutpoint2 <span class="sc">-</span> eta) <span class="sc">-</span> <span class="fu">pnorm</span>(cutpoint1 <span class="sc">-</span> eta))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1537839</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>X[, <span class="st">"treat"</span>] <span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>bh <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit.c2)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span> X <span class="sc">%*%</span> bh</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>cutpoint2 <span class="ot">&lt;-</span> fit.c2<span class="sc">$</span>zeta[<span class="dv">2</span>]</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>cutpoint1 <span class="ot">&lt;-</span> fit.c2<span class="sc">$</span>zeta[<span class="dv">1</span>]</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">pnorm</span>(cutpoint2 <span class="sc">-</span> eta) <span class="sc">-</span> <span class="fu">pnorm</span>(cutpoint1 <span class="sc">-</span> eta))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1726136</code></pre>
</div>
</div>
</details>
<section id="a-note-on-robust-standard-errors" class="level3" data-number="8.5.1">
<h3 data-number="8.5.1" class="anchored" data-anchor-id="a-note-on-robust-standard-errors"><span class="header-section-number">8.5.1</span> A note on robust standard errors</h3>
<p>In writing down our likelihood equations, we assume our observations are independent. However, that is not always the case. For example, in Paluck and Green’s article, the experimental design is based on clustered pairs, and the treatment is randomly assigned to one unit of a pair. Ideally, we want to account for this non-independence in our model.</p>
<p>In linear models (e.g., using <code>lm</code>), this is often accomplished post-estimation by adjusting the standard errors. We might adjust them for clustering if we have a case like the authors’ or for suspected heteroskedasticity (maybe the errors are not constant, but instead, are larger for higher values of a given X variable).</p>
<p>Professor Jeffrey Wooldridge, an expert on econometrics, is a proponent of robust standard errors, given the stringent assumption of homoskedasticity.</p>
<p><img src="images/woolrobust1.png" class="img-fluid" style="width:60.0%"></p>
<p>There are many types of these “robust” standard errors, and we may encounter more later in the course. Generally, what each of these robust standard errors does is alter the nature of the variance covariance matrix from which we extract the standard errors. Recall in OLS, we have an expression for the variance of the coefficients that looks like the below. By assuming constant error variance, we can simplify it.</p>
<span class="math display">\[\begin{align*}
\mathbf{V}(\widehat{\beta})  &amp;= (X^T X)^{-1}X^T \mathbf{V}( \epsilon) X (X^T X)^{-1}\\
&amp;= \underbrace{(X^T X)^{-1}X^T \sigma^2I_n X (X^T X)^{-1}}_\text{Assume homoskedasticity}\\
&amp;= \underbrace{\sigma^2(X^T X)^{-1} X^T X (X^T X)^{-1}}_\text{Because it is a constant, we can move it out in front of the matrix multiplication, and then simplify the terms.}  \\
&amp;= \sigma^2(X^T X)^{-1}
\end{align*}\]</span>
<p>After we plug in <span class="math inline">\(\hat \sigma^2\)</span> for <span class="math inline">\(\sigma^2\)</span>, we arrive at our variance-covariance matrix <code>vcov</code>:<span class="math inline">\(\hat \sigma^2(X^T X)^{-1}=\frac{1}{N-K} \mathbf{e'e}(X^T X)^{-1}\)</span></p>
<p>When we don’t have constant error variance, we have to pause here:</p>
<p><span class="math inline">\((X^T X)^{-1}X^T \mathbf{V}( \epsilon) X (X^T X)^{-1}\)</span></p>
<p>and assume something different about the structure of the error terms in <span class="math inline">\(\mathbf{V}( \epsilon)\)</span> and end up with a different final expression for <code>vcov</code>.</p>
<p>The robust estimators differ in how they specify an estimate for <span class="math inline">\(\mathbf{V}( \epsilon) = \Sigma\)</span> and whether they take into account the degrees of freedom in the model (number of observations, number of variables, number of clusters, etc.)</p>
<p>For example, let’s fit the authors’ model as a linear model using MacKinnon and White HC1 robust standard errors. Those specify the following inside portion for an estimate of <span class="math inline">\(\mathbf{V}( \epsilon)\)</span>.This is what Stata uses as a default “robust” standard error:</p>
<p><span class="math inline">\(\Sigma = \frac{n}{n-k} \text{diag}(\hat \epsilon_i^2)\)</span></p>
<p>This means we have a slightly different term for each observation instead of a constant estimate <span class="math inline">\(\hat \sigma^2\)</span> for all observations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>fit.lin <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">as.numeric</span>(dissent) <span class="sc">~</span> treat <span class="sc">+</span> <span class="fu">factor</span>(site_pr), </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>pg)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Option 1: Adjusting for heteroskedasticity</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>newvcov <span class="ot">&lt;-</span> <span class="fu">vcovHC</span>(fit.lin, <span class="at">type=</span><span class="st">"HC1"</span>)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">diag</span>(newvcov))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     (Intercept)            treat factor(site_pr)2 factor(site_pr)3 
       0.1661596        0.1145570        0.2128812        0.2158906 
factor(site_pr)4 factor(site_pr)5 factor(site_pr)6 factor(site_pr)7 
       0.2164289        0.2176110        0.2175578        0.2085747 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Option 2: Adjusting for heteroskedasticity</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(estimatr)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>fit.lin2 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(<span class="fu">as.numeric</span>(dissent) <span class="sc">~</span> treat <span class="sc">+</span> <span class="fu">factor</span>(site_pr), </span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>pg, <span class="at">se_type =</span> <span class="st">"stata"</span>)</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(fit.lin2)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     (Intercept)            treat factor(site_pr)2 factor(site_pr)3 
       0.1661596        0.1145570        0.2128812        0.2158906 
factor(site_pr)4 factor(site_pr)5 factor(site_pr)6 factor(site_pr)7 
       0.2164289        0.2176110        0.2175578        0.2085747 </code></pre>
</div>
</div>
<p>Another adjustment takes into account the grouped or “clustered” nature of the data. Here, we have a separate estimate for each group in the data. This can be implemented in R by using <code>vcovCL</code> or the <code>clusters</code> argument in <code>lm_robust</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Option 1: Adjusting for clustering</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>newvcov <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(fit.lin, <span class="at">type=</span><span class="st">"HC1"</span>, <span class="at">cadjust=</span>T, <span class="at">cluster =</span> pg<span class="sc">$</span>sitcode)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">diag</span>(newvcov))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     (Intercept)            treat factor(site_pr)2 factor(site_pr)3 
      0.07685775       0.07066623       0.12388030       0.09271341 
factor(site_pr)4 factor(site_pr)5 factor(site_pr)6 factor(site_pr)7 
      0.07174477       0.12894245       0.20605985       0.06962861 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Option 2: Adjusting for clustering</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(estimatr)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>fit.lin2 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(<span class="fu">as.numeric</span>(dissent) <span class="sc">~</span> treat <span class="sc">+</span> <span class="fu">factor</span>(site_pr), </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>pg, <span class="at">se_type =</span> <span class="st">"stata"</span>, <span class="at">clusters =</span> sitcode)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(fit.lin2)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     (Intercept)            treat factor(site_pr)2 factor(site_pr)3 
      0.07685775       0.07066623       0.12388030       0.09271341 
factor(site_pr)4 factor(site_pr)5 factor(site_pr)6 factor(site_pr)7 
      0.07174477       0.12894245       0.20605985       0.06962861 </code></pre>
</div>
</div>
<p>This is all great, but the authors don’t have a linear model, they have an ordered probit model. It turns out that people have developed similar robust standard error estimators to adjust the standard errors from these non-linear models. For more details, see slides from <a href="https://projects.iq.harvard.edu/files/gov2001/files/sesection_5.pdf">Molly Roberts</a> on this point.</p>
<p>These take a slightly different form, but the intuition is the same. What we are altering is the structure of the variance-covariance matrix (which is a function of the Hessian in the likelihood case), making adjustments across all observations or clusters of observations.</p>
<p>We can also implement these in R using HC0 standard errors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Adjusting for clustered standard errors</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>fit.c2 <span class="ot">&lt;-</span> <span class="fu">polr</span>(<span class="fu">as.factor</span>(dissent) <span class="sc">~</span> treat <span class="sc">+</span> <span class="fu">factor</span>(site_pr), </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>pg, <span class="at">method=</span><span class="st">"probit"</span>, <span class="at">Hess =</span>T)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>clval <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(fit.c2, <span class="at">type=</span><span class="st">"HC0"</span>, <span class="at">cluster =</span> pg<span class="sc">$</span>sitcode)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can compare these standard errors to column 2 from Table 3 in the paper.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">diag</span>(clval))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           treat factor(site_pr)2 factor(site_pr)3 factor(site_pr)4 
      0.06212521       0.11636326       0.07559847       0.06387804 
factor(site_pr)5 factor(site_pr)6 factor(site_pr)7              1|2 
      0.10879657       0.16765260       0.06391195       0.07144512 
             2|3              3|4 
      0.07494704       0.08409084 </code></pre>
</div>
</div>
<p>The <code>coeftest</code> function in R, when applied to a new <code>vcov</code> will reproduce the full regression output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(fit.c2, <span class="at">vcov=</span>clval)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
z test of coefficients:

                  Estimate Std. Error z value  Pr(&gt;|z|)    
treat             0.284843   0.062125  4.5850  4.54e-06 ***
factor(site_pr)2 -0.174805   0.116363 -1.5022 0.1330371    
factor(site_pr)3 -0.255136   0.075598 -3.3749 0.0007385 ***
factor(site_pr)4 -0.177318   0.063878 -2.7759 0.0055052 ** 
factor(site_pr)5 -0.305472   0.108797 -2.8077 0.0049892 ** 
factor(site_pr)6 -0.113847   0.167653 -0.6791 0.4970975    
factor(site_pr)7  0.046596   0.063912  0.7291 0.4659633    
1|2              -0.646720   0.071445 -9.0520 &lt; 2.2e-16 ***
2|3              -0.190723   0.074947 -2.5448 0.0109348 *  
3|4               0.138053   0.084091  1.6417 0.1006487    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>I got 99 problems, and standard errors are just one</strong></p>
<p>However, robust standard errors cannot correct underlying model misspecification. Recall that the initial likelihood equation is what assumes independence– this is the equation we use for everything, not only for computing standard errors but also for estimating the coefficients themselves. If we truly believe we have dependence among our observations, we might consider using an entirely different likelihood function– one that incorporates this dependence, instead of just adjusting the standard errors after the fact.</p>
<p>Nonetheless, we may still think our model is good enough, even if not “correct.” So long as you recognize that the robust standard errors don’t correct for this underlying problem, some are still proponents for using robust standard errors in these cases. For example, Wooldridge recommends reporting robust standard errors, and writes,</p>
<p><img src="images/woolrobust2.png" class="img-fluid" style="width:60.0%"> <img src="images/woolrobust3.png" class="img-fluid" style="width:60.0%"></p>
</section>
</section>
<section id="ordinal-tutorial" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="ordinal-tutorial"><span class="header-section-number">8.6</span> Ordinal Tutorial</h2>
<p>For this example, we will replicate a portion of the article”How Empathic Concern Fuels Partisan Polarization” by Elizabeth N. Simas, Scott Clifford, and Justin H. Kirkland.published in 2020 in the <em>American Political Science Review</em>. Replication files are available <a href="https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/RJL2DK">here</a></p>
<p>Abstract. <em>Over the past two decades, there has been a marked increase in partisan social polarization, leaving scholars in search of solutions to partisan conflict. The psychology of intergroup relations identifies empathy as one of the key mechanisms that reduces intergroup conflict, and some have suggested that a lack of empathy has contributed to partisan polarization. Yet, empathy may not always live up to this promise. We argue that, in practice, the experience of empathy is biased toward one’s ingroup and can actually exacerbate political polarization. First, using a large, national sample, we demonstrate that higher levels of dispositional empathic concern are associated with higher levels of affective polarization. Second, using an experimental design, we show that individuals high in empathic concern show greater partisan bias in evaluating contentious political events. Taken together, our results suggest that, contrary to popular views, higher levels of dispositional empathy actually facilitate partisan polarization.</em></p>
<p>We are going to replicate Study 1’s analysis testing Hypotheses 1 and 2. Here, the authors conduct an original survey fielded by YouGov during May 2016 with 1000 respondents.</p>
<p>Let’s load the data.</p>
<ul>
<li>How many observations do we have?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>emp <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"https://github.com/ktmccabe/teachingdata/blob/main/week6.dta?raw=true"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The authors’ first two hypotheses are:</p>
<ul>
<li>Empathic concern should predict more positive affect for copartisans, relative to outpartisans (H1).</li>
<li>Empathic concern should increase negative affect for outpartisans (H2).</li>
</ul>
<p>Outcome Measure: “To examine this type of partisan favoritism, we utilize responses to two questions asking respondents to rate the Democratic and Republican Parties on a seven-point scale ranging from”very favorable” to “very unfavorable.” We then subtract respondents’ ratings of the opposite party from their ratings of their own party to create an ordinal measure that ranges from six (highest inparty rating, lowest outparty rating) to −6 (lowest inparty rating and highest outparty rating)”</p>
<ul>
<li><code>affectpol</code>: an ordinal measure that ranges from six (highest inparty rating, lowest outparty rating) to −6 (lowest inparty rating and highest outparty rating)”</li>
<li><code>outfav</code>: rating of opposing party on a seven-point scale ranging from “very favorable” to “very unfavorable.”</li>
</ul>
<p>Let’s take a look at these variables.</p>
<ul>
<li>Are they coded as the authors describe?</li>
<li>What class are they currently?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(emp<span class="sc">$</span>affectpol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 -6  -4  -3  -2  -1   0   1   2   3   4   5   6 
  1   1   4   5  11 106  80  80 103 148 137 116 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(emp<span class="sc">$</span>affectpol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(emp<span class="sc">$</span>outfav)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  1   2   3   4   5   6   7 
431 163  73  85  16  16   8 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(emp<span class="sc">$</span>outfav)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
</div>
<p>Independent Variables.</p>
<ul>
<li><code>empconc</code>: Mean of empathetic concern items from the Interpersonal Reactivity Index (IRI)</li>
<li>Additional variables to measure other dimensions of empathy:
<ul>
<li><code>empdist</code> personal distress, <code>emppers</code> perspective taking, <code>empfant</code> fantasy</li>
</ul></li>
<li>Additional controls for strength of party identification <code>pidext</code>, ideological extremity <code>ideoext</code>, news interest <code>news</code>, dummy variable for party membership <code>dem</code>, and demographics: <code>educ</code>, <code>age</code>, <code>male</code>, <code>white</code>, <code>inc3miss</code> (income)</li>
</ul>
<p>What type of model could they use to test H1 and H2?</p>
<p>They choose to run an ordinal logistic regression. Let’s do as they do. To run an ordinal model in R, we need to make sure our outcome is ordinal! (meaning a factor variable)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>emp<span class="sc">$</span>outfav <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(emp<span class="sc">$</span>outfav)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(emp<span class="sc">$</span>outfav)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  1   2   3   4   5   6   7 
431 163  73  85  16  16   8 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(emp<span class="sc">$</span>outfav)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
</div>
<p>Go ahead and replicate the first regression in the table with all of the controls, making sure to treat income as a factor variable but education as a numeric variable.</p>
<p><img src="images/simas1.png" class="img-fluid"></p>
<ul>
<li>Note: your coefficients will not exactly match because the authors weight their data using survey weights.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>fit.emp <span class="ot">&lt;-</span> <span class="fu">polr</span>(outfav <span class="sc">~</span> empconc <span class="sc">+</span> empdist <span class="sc">+</span> emppers <span class="sc">+</span> empfant <span class="sc">+</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">+</span> pidext <span class="sc">+</span> ideoext <span class="sc">+</span> news <span class="sc">+</span> dem <span class="sc">+</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(educ) <span class="sc">+</span> age <span class="sc">+</span> male <span class="sc">+</span> white <span class="sc">+</span> <span class="fu">factor</span>(inc3miss),</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>emp, <span class="at">Hess=</span>T, <span class="at">method=</span><span class="st">"logistic"</span>)</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.emp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
polr(formula = outfav ~ empconc + empdist + emppers + empfant + 
    +pidext + ideoext + news + dem + as.numeric(educ) + age + 
    male + white + factor(inc3miss), data = emp, Hess = T, method = "logistic")

Coefficients:
                      Value Std. Error  t value
empconc           -0.805771   0.492455 -1.63623
empdist            0.321857   0.413656  0.77808
emppers            0.433013   0.528121  0.81991
empfant           -0.020821   0.408769 -0.05093
pidext            -0.246698   0.095193 -2.59155
ideoext           -0.556725   0.072652 -7.66288
news              -0.557133   0.094192 -5.91487
dem                0.002573   0.156964  0.01639
as.numeric(educ)   0.071461   0.054630  1.30809
age               -0.004130   0.004784 -0.86345
male              -0.310108   0.160583 -1.93114
white             -0.015491   0.176718 -0.08766
factor(inc3miss)2 -0.049340   0.196223 -0.25145
factor(inc3miss)3 -0.127770   0.200626 -0.63686
factor(inc3miss)4 -0.148389   0.242841 -0.61105

Intercepts:
    Value   Std. Error t value
1|2 -3.4355  0.6385    -5.3808
2|3 -2.3032  0.6308    -3.6513
3|4 -1.5674  0.6259    -2.5042
4|5 -0.2119  0.6325    -0.3351
5|6  0.3713  0.6467     0.5741
6|7  1.5460  0.7177     2.1541

Residual Deviance: 1828.862 
AIC: 1870.862 
(245 observations deleted due to missingness)</code></pre>
</div>
</div>
<ul>
<li>Let’s take a look out how the weights affect the result by using the <code>survey</code> package.
<ul>
<li>There are many options in establishing an <code>svydesign</code>. Ours is a relatively simple case where all we have is a vector of weights. In other cases, samples might include information about the sampling units or strata.</li>
<li>Once we establish an <code>svydesign</code> object, we now need to use <code>svy</code> commands for our operations, such as <code>svymean</code> or <code>svyglm</code> or <code>svyolr</code></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages("survey", dependencies =T)</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>empd <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids=</span><span class="sc">~</span><span class="dv">1</span>, <span class="at">weights =</span> emp<span class="sc">$</span>weight_group, <span class="at">data=</span>emp)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>fit.empw2 <span class="ot">&lt;-</span> <span class="fu">svyolr</span>(outfav <span class="sc">~</span> empconc <span class="sc">+</span> empdist <span class="sc">+</span> emppers <span class="sc">+</span> empfant <span class="sc">+</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">+</span> pidext <span class="sc">+</span> ideoext <span class="sc">+</span> news <span class="sc">+</span> dem <span class="sc">+</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(educ) <span class="sc">+</span> age <span class="sc">+</span> </span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>                    male <span class="sc">+</span> white <span class="sc">+</span> <span class="fu">factor</span>(inc3miss), </span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">design=</span>empd, <span class="at">method=</span><span class="st">"logistic"</span>)</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.empw2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
svyolr(outfav ~ empconc + empdist + emppers + empfant + +pidext + 
    ideoext + news + dem + as.numeric(educ) + age + male + white + 
    factor(inc3miss), design = empd, method = "logistic")

Coefficients:
                          Value  Std. Error    t value
empconc           -1.4141333759 0.585070456 -2.4170309
empdist            0.7759996312 0.561768870  1.3813504
emppers            1.1700466598 0.672754809  1.7391874
empfant            0.9733692488 0.475484526  2.0471103
pidext            -0.3281938237 0.124714241 -2.6315665
ideoext           -0.4970353573 0.106530714 -4.6656531
news              -0.5759629296 0.130609880 -4.4097960
dem               -0.0456812052 0.195236242 -0.2339791
as.numeric(educ)   0.0284167135 0.065624317  0.4330211
age               -0.0007305433 0.005493873 -0.1329742
male              -0.1759866726 0.212493495 -0.8281979
white              0.0366164598 0.215144017  0.1701951
factor(inc3miss)2 -0.0470362687 0.226737718 -0.2074479
factor(inc3miss)3 -0.0794217660 0.246811912 -0.3217907
factor(inc3miss)4 -0.0588030650 0.330225820 -0.1780693

Intercepts:
    Value   Std. Error t value
1|2 -2.9118  0.9199    -3.1652
2|3 -1.7749  0.9029    -1.9658
3|4 -1.0853  0.9058    -1.1982
4|5  0.3080  0.8948     0.3442
5|6  0.9101  0.9006     1.0106
6|7  2.8740  0.9296     3.0918
(245 observations deleted due to missingness)</code></pre>
</div>
</div>
<p>The weights seem to make a difference! Now we are closely matching what the authors report. The use of survey weights represents yet another point of researcher discretion.</p>
<p>Let’s use the weighted results and proceed to make them easier to interpret. Recall, H2 was: <em>Empathic concern should increase negative affect for outpartisans (H2).</em></p>
<p>We want to show how negative affect toward the outparty changes across levels of empathic concern. How should we visualize this?</p>
<ol type="1">
<li>Could calculate probabilities of being in each of the <code>outfav</code> seven categories across different levels of empathetic concern.</li>
<li>Could calculate probabilities of being in theoretically interesting <code>outfav</code> categories across different levels of empathetic concern.</li>
</ol>
<p>Note: in each case, we need to decide where to set our covariate values and potentially also calculate uncertainty estimates.</p>
<p>What do they do? (focus on the right side for the out-party measure)</p>
<p><img src="images/simas2.png" class="img-fluid"></p>
<p>Let’s estimate the probability of being in the lowest category for empathy values from 0 to 1 by .2 intervals. <strong><em>Let’s set all covariates at their observed values.</em></strong></p>
<ul>
<li>We could do this in <code>predict</code> or manually. We will do it manually for now.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Set covariates to particular values (here, we hold at observed)</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(fit.empw2)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> X[, <span class="sc">-</span><span class="dv">1</span>] <span class="co">#remove intercept</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>X[,<span class="st">"empconc"</span> ] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Find Xb and zeta</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit.empw2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          empconc           empdist           emppers           empfant 
    -1.4141333759      0.7759996312      1.1700466598      0.9733692488 
           pidext           ideoext              news               dem 
    -0.3281938237     -0.4970353573     -0.5759629296     -0.0456812052 
 as.numeric(educ)               age              male             white 
     0.0284167135     -0.0007305433     -0.1759866726      0.0366164598 
factor(inc3miss)2 factor(inc3miss)3 factor(inc3miss)4               1|2 
    -0.0470362687     -0.0794217660     -0.0588030650     -2.9118275702 
              2|3               3|4               4|5               5|6 
    -1.7749101884     -1.0852947154      0.3080104278      0.9101173775 
              6|7 
     2.8740344326 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this piece [1:ncol(X)] makes sure we omit the zetas</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this is only necessary for svyolr. The polr function already omits zetas from coef()</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit.empw2)[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(X)]</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span> X <span class="sc">%*%</span> b</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>zeta <span class="ot">&lt;-</span> fit.empw2<span class="sc">$</span>zeta</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Find Pr(lowest category)</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>emp0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">plogis</span>(zeta[<span class="dv">1</span>] <span class="sc">-</span> eta))</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>emp0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3025648</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Repeat for each value of empconc of interest</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>X[,<span class="st">"empconc"</span>] <span class="ot">&lt;-</span> .<span class="dv">2</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Find Xb and zeta</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span> X <span class="sc">%*%</span> <span class="fu">coef</span>(fit.empw2)[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(X)]</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>zeta <span class="ot">&lt;-</span> fit.empw2<span class="sc">$</span>zeta</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Find Pr(lowest category)</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>emp2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">plogis</span>(zeta[<span class="dv">1</span>] <span class="sc">-</span> eta))</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>emp2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3555723</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Or put it in a function to be faster</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>findpr <span class="ot">&lt;-</span> <span class="cf">function</span>(val){</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  X[,<span class="st">"empconc"</span>] <span class="ot">&lt;-</span> val</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find Xb and zeta</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>  eta <span class="ot">&lt;-</span> X <span class="sc">%*%</span> <span class="fu">coef</span>(fit.empw2)[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(X)]</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>  zeta <span class="ot">&lt;-</span> fit.empw2<span class="sc">$</span>zeta</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Find Pr(lowest category)</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">plogis</span>(zeta[<span class="dv">1</span>] <span class="sc">-</span> eta))</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pr)</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Does it work? Test</span></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a><span class="fu">findpr</span>(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3025648</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Repeat for all values of empathy</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>emp.prs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">2</span>), findpr)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>emp.prs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3025648 0.3555723 0.4116936 0.4696702 0.5281235 0.5856687</code></pre>
</div>
</div>
<p>We can visualize these estimates similar to the authors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">2</span>),</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">y=</span>emp.prs,</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">7</span>),</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">"l"</span>,</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Empathic Concern"</span>,</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Outparty Favorability </span><span class="sc">\n</span><span class="st"> Pr(Outparty Very Unfavorable)"</span>,</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main=</span>.<span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="08-OrdinalandOutcomes_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We could add lines for all categories. We’ll just add it to the function for now.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>findprall <span class="ot">&lt;-</span> <span class="cf">function</span>(val){</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  X[,<span class="st">"empconc"</span>] <span class="ot">&lt;-</span> val</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find Xb and zeta</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  eta <span class="ot">&lt;-</span> X <span class="sc">%*%</span> <span class="fu">coef</span>(fit.empw2)[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(X)]</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>  zeta <span class="ot">&lt;-</span> fit.empw2<span class="sc">$</span>zeta</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Find Pr(7th lowest category)</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>  pr7 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">plogis</span>(zeta[<span class="dv">6</span>] <span class="sc">-</span> eta))</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Find Pr(6th lowest category)</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>  pr6 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">plogis</span>(zeta[<span class="dv">6</span>] <span class="sc">-</span> eta) <span class="sc">-</span> <span class="fu">plogis</span>(zeta[<span class="dv">5</span>] <span class="sc">-</span> eta))</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Find Pr(5th lowest category)</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>  pr5 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">plogis</span>(zeta[<span class="dv">5</span>] <span class="sc">-</span> eta) <span class="sc">-</span> <span class="fu">plogis</span>(zeta[<span class="dv">4</span>] <span class="sc">-</span> eta))</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Find Pr(4th lowest category)</span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>  pr4 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">plogis</span>(zeta[<span class="dv">4</span>] <span class="sc">-</span> eta) <span class="sc">-</span> <span class="fu">plogis</span>(zeta[<span class="dv">3</span>] <span class="sc">-</span> eta))</span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Find Pr(3rd lowest category)</span></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>  pr3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">plogis</span>(zeta[<span class="dv">3</span>] <span class="sc">-</span> eta) <span class="sc">-</span> <span class="fu">plogis</span>(zeta[<span class="dv">2</span>] <span class="sc">-</span> eta))</span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Find Pr(2nd lowest category)</span></span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>  pr2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">plogis</span>(zeta[<span class="dv">2</span>] <span class="sc">-</span> eta) <span class="sc">-</span> <span class="fu">plogis</span>(zeta[<span class="dv">1</span>] <span class="sc">-</span> eta))</span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Find Pr(lowest category)</span></span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>  pr1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">plogis</span>(zeta[<span class="dv">1</span>] <span class="sc">-</span> eta))</span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(pr1, pr2, pr3, pr4, pr5, pr6, pr7))</span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Repeat for all values of empathy</span></span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a>emp.prsall <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">2</span>), findprall)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A note on the survey weights:</p>
<ul>
<li>When we take the <code>mean()</code> of our estimates for each observation, we are treating each row of our <span class="math inline">\(X\)</span> matrix as if it should have equal weight in this mean. This is normally fine, but with weighted data, we might instead want to weight the mean, according to the survey weights we used in our regression. The function <code>weighted.mean</code> can facilitate this. Either approach is valid, but you may want to remember this distinction and the possibility that you could even incorporate the survey weights at this final stage.</li>
</ul>
<p>We can add these lines to the plot. Yikes! A bit messy. You can see why they focus on the first category only.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">2</span>),</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">y=</span>emp.prsall[<span class="dv">1</span>,],</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">"l"</span>,</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Empathic Concern"</span>,</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Outparty Favorability </span><span class="sc">\n</span><span class="st"> Pr(Outparty Very Unfavorable)"</span>,</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main=</span>.<span class="dv">8</span>)</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">2</span>), <span class="at">y=</span>emp.prsall[<span class="dv">2</span>,], <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">2</span>), <span class="at">y=</span>emp.prsall[<span class="dv">3</span>,], <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">2</span>), <span class="at">y=</span>emp.prsall[<span class="dv">4</span>,], <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lty=</span><span class="dv">4</span>)</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">2</span>), <span class="at">y=</span>emp.prsall[<span class="dv">5</span>,], <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lty=</span><span class="dv">5</span>)</span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">2</span>), <span class="at">y=</span>emp.prsall[<span class="dv">6</span>,], <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lty=</span><span class="dv">6</span>)</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">2</span>), <span class="at">y=</span>emp.prsall[<span class="dv">7</span>,], <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lty=</span><span class="dv">7</span>)</span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,  <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="fu">c</span>(<span class="st">"Very Unfav"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>, <span class="st">"Very Fav"</span>), <span class="at">cex=</span>.<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="08-OrdinalandOutcomes_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A last step would be to calculate uncertainty. Just like before, we could use simulation or the bootstrap method. In the bootstrap method, the manual calculations would be the “meat” of the bootstrap function that you used in the previous course notes section.</p>
<p>A special note: The <code>svyolr</code> function does not appear compatible with the <code>prediction</code> function. As an alternative, we could fit the <code>polr</code> model with an extra argument for weights. These should produce the same coefficient estimates, though the standard errors might be incorrect. You could potentially use this to generate the raw probability estimates. See for example, estimates for being in category 1 below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>fit.emp2 <span class="ot">&lt;-</span> <span class="fu">polr</span>(outfav <span class="sc">~</span> empconc <span class="sc">+</span> empdist <span class="sc">+</span> emppers <span class="sc">+</span> empfant <span class="sc">+</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">+</span> pidext <span class="sc">+</span> ideoext <span class="sc">+</span> news <span class="sc">+</span> dem <span class="sc">+</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(educ) <span class="sc">+</span> age <span class="sc">+</span> male <span class="sc">+</span> white <span class="sc">+</span> <span class="fu">factor</span>(inc3miss),</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>emp, <span class="at">Hess=</span>T, <span class="at">method=</span><span class="st">"logistic"</span>, <span class="at">weights =</span> emp<span class="sc">$</span>weight_group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.emp2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
polr(formula = outfav ~ empconc + empdist + emppers + empfant + 
    +pidext + ideoext + news + dem + as.numeric(educ) + age + 
    male + white + factor(inc3miss), data = emp, weights = emp$weight_group, 
    Hess = T, method = "logistic")

Coefficients:
                       Value Std. Error t value
empconc           -1.4141936   0.479987 -2.9463
empdist            0.7759968   0.412555  1.8810
emppers            1.1700975   0.527905  2.2165
empfant            0.9733691   0.406788  2.3928
pidext            -0.3281915   0.097894 -3.3525
ideoext           -0.4970277   0.078991 -6.2922
news              -0.5759557   0.094099 -6.1207
dem               -0.0456691   0.161136 -0.2834
as.numeric(educ)   0.0284158   0.056125  0.5063
age               -0.0007309   0.004667 -0.1566
male              -0.1759908   0.164116 -1.0724
white              0.0366286   0.168809  0.2170
factor(inc3miss)2 -0.0470201   0.205414 -0.2289
factor(inc3miss)3 -0.0794134   0.207121 -0.3834
factor(inc3miss)4 -0.0587784   0.233469 -0.2518

Intercepts:
    Value   Std. Error t value
1|2 -2.9118  0.6315    -4.6109
2|3 -1.7749  0.6251    -2.8394
3|4 -1.0853  0.6211    -1.7473
4|5  0.3080  0.6257     0.4923
5|6  0.9101  0.6363     1.4303
6|7  2.8741  0.7763     3.7022

Residual Deviance: 1862.152 
AIC: 1904.152 
(245 observations deleted due to missingness)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="do">## marginaleffects</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>preds.me <span class="ot">&lt;-</span> <span class="fu">avg_predictions</span>(fit.emp2, <span class="at">by =</span> <span class="st">"empconc"</span>,</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">newdata =</span> <span class="fu">datagridcf</span>(<span class="at">empconc =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">2</span>)))</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(preds.me, group<span class="sc">==</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Group Estimate Std. Error     z Pr(&gt;|z|)     S CI low CI high
     1    0.303     0.0616  4.92   &lt;0.001  20.1  0.182   0.423
     1    0.356     0.0485  7.34   &lt;0.001  42.0  0.261   0.451
     1    0.412     0.0333 12.36   &lt;0.001 114.1  0.346   0.477
     1    0.470     0.0200 23.54   &lt;0.001 404.4  0.431   0.509
     1    0.528     0.0201 26.33   &lt;0.001 505.1  0.489   0.567
     1    0.586     0.0333 17.60   &lt;0.001 227.9  0.520   0.651

Columns: group, empconc, estimate, std.error, statistic, p.value, s.value, conf.low, conf.high </code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="do">## prediction</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">prediction</span>(fit.emp2, <span class="at">at=</span><span class="fu">list</span>(<span class="at">empconc =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">2</span>)), <span class="at">category=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in check_values(data, at): A 'at' value for 'empconc' is outside
observed data range (0.0357142873108387,1)!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">summary</span>(preds), <span class="at">digits=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> at(empconc) Prediction SE  z  p lower upper
         0.0      0.303 NA NA NA    NA    NA
         0.2      0.356 NA NA NA    NA    NA
         0.4      0.412 NA NA NA    NA    NA
         0.6      0.470 NA NA NA    NA    NA
         0.8      0.528 NA NA NA    NA    NA
         1.0      0.586 NA NA NA    NA    NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compare with the manual approach</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(emp.prsall[<span class="dv">1</span>,], <span class="at">digits=</span><span class="dv">3</span>) <span class="co"># category 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.303 0.356 0.412 0.470 0.528 0.586</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./07-QuantitiesofInterest.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Quantities of Interest</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./09-NominalOutcomes.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Multinomial Outcomes</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>