<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MLE 2023 - 11&nbsp; Sample Selection Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./12-PanelData.html" rel="next">
<link href="./10-CountData.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./11-SampleSelection.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Sample Selection Models</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MLE 2023</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Maxmimum Likelihood Fall 2023</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-ROverview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">R Overview</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-TheMATH.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Math</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-ReviewofOLS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Review of OLS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-IntrotoMaximumLikelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to MLE</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-BinaryOutcomes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Binary Dependent Variables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-QuantitiesofInterest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Quantities of Interest</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-OrdinalandOutcomes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Ordinal Outcomes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-NominalOutcomes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Multinomial Outcomes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-CountData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Count data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-SampleSelection.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Sample Selection Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-PanelData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Panel and Hierarchical Data</span></span></a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Section Contents</h2>
   
  <ul>
  <li><a href="#sample-selection" id="toc-sample-selection" class="nav-link active" data-scroll-target="#sample-selection"><span class="header-section-number">11.1</span> Sample Selection</a>
  <ul>
  <li><a href="#how-do-we-go-about-estimating-this" id="toc-how-do-we-go-about-estimating-this" class="nav-link" data-scroll-target="#how-do-we-go-about-estimating-this"><span class="header-section-number">11.1.1</span> How do we go about estimating this?</a></li>
  <li><a href="#sample-selection-model-assumptions" id="toc-sample-selection-model-assumptions" class="nav-link" data-scroll-target="#sample-selection-model-assumptions"><span class="header-section-number">11.1.2</span> Sample Selection Model Assumptions</a></li>
  </ul></li>
  <li><a href="#fitting-sample-selection-in-r" id="toc-fitting-sample-selection-in-r" class="nav-link" data-scroll-target="#fitting-sample-selection-in-r"><span class="header-section-number">11.2</span> Fitting Sample Selection in R</a></li>
  <li><a href="#heckman-example-using-survey-data" id="toc-heckman-example-using-survey-data" class="nav-link" data-scroll-target="#heckman-example-using-survey-data"><span class="header-section-number">11.3</span> Heckman Example Using Survey Data</a></li>
  <li><a href="#tobit-model-aka-censored-regression-model" id="toc-tobit-model-aka-censored-regression-model" class="nav-link" data-scroll-target="#tobit-model-aka-censored-regression-model"><span class="header-section-number">11.4</span> Tobit Model aka Censored regression model</a>
  <ul>
  <li><a href="#tobit-model-assumptions" id="toc-tobit-model-assumptions" class="nav-link" data-scroll-target="#tobit-model-assumptions"><span class="header-section-number">11.4.1</span> Tobit Model Assumptions</a></li>
  </ul></li>
  <li><a href="#truncated-models" id="toc-truncated-models" class="nav-link" data-scroll-target="#truncated-models"><span class="header-section-number">11.5</span> Truncated Models</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="selection" class="quarto-section-identifier"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Sample Selection Models</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This section will provide a brief overview of models designed to address issues where we do not observe our full outcome data, or the outcome is censored or truncated in some way. In each of these cases, if we only use the standard methods discussed so far in the course, we may end up with biased estimates.</p>
<p>Here is a brief video overview.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/sY6H9LuamGI" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<table class="table">
<colgroup>
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 26%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Sample</th>
<th>Y</th>
<th>X</th>
<th style="text-align: right;">Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Censored</td>
<td>y is known exactly only if some criterion defined in terms of y is met.</td>
<td>x variables are observed for the entire sample, regardless of whether y is observed exactly</td>
<td style="text-align: right;">If income is measured exactly only if above the poverty line. All other incomes are reported at the poverty line.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sample Selected</td>
<td>y is observed only if a criteria defined in terms of some other random variable (Z) is met.</td>
<td>the determinants of whether Z =1 are observed for the entire sample, regardless of whether y is observed or not</td>
<td style="text-align: right;">Survey data with item or unit non-response</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Truncated</td>
<td>y is known only if some criterion defined in terms of y is met</td>
<td>x variables are observed only if y is observed</td>
<td style="text-align: right;">Donations to political campaigns</td>
</tr>
</tbody>
</table>
<p>Here are supplemental resources</p>
<ul>
<li>King, Gary. 1998. Unifying political methodology: The likelihood theory of statistical inference. University of Michigan Press. Chapters: 9. Available online through Rutgers libraries.</li>
<li>Fox, John. Applied Regression and Generalized Linear Models. Excerpts from Chapter 20 (see Canvas)</li>
<li>The documentation for the <code>sampleSelection</code> package in R is <a href="https://cran.r-project.org/web/packages/sampleSelection/vignettes/selection.pdf">here</a></li>
</ul>
<section id="sample-selection" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="sample-selection"><span class="header-section-number">11.1</span> Sample Selection</h2>
<p>Here are a few thought exercises to underscore the potential issues with common sources of data.</p>
<p><strong><em>Graduate School Admissions</em></strong> Suppose we observe that college grades are uncorrelated with success in graduate school. Can we infer that college grades are irrelevant?</p>
<ul>
<li>No.&nbsp;applicants admitted with low grades may not be representative of the population with low grades. Unmeasured variables (e.g.&nbsp;motivation) used in the admissions process might explain why those who enter graduate school with low grades do as well as those who enter graduate school with high grades.
<ul>
<li>Selection into graduate school is not random</li>
</ul></li>
<li>Implication: may be unmeasured factors that bias our inferences from the sample we do have complete data about (graduate school students)</li>
<li>Solution: May want to use a sample selection model to account for non-random sample</li>
</ul>
<p><strong><em>What leads rivals to wage war?</em></strong></p>
<p><a href="https://doi.org/10.2307/2669352">Lemke and Reed 2001</a> argue that if we only focus on rivals, this may lead to biased inference.</p>
<ul>
<li>Need first DV: whether members of “great power” dyads are rivals</li>
<li>In addition to second: whether “great power rivals” wage war</li>
</ul>
<p>“We discover that what makes great powers more likely to be rivals is statistically related to their propensity to experience war.” Results suggest that any analysis of the onset of war between rivals that fails to control for the prior influence of variables on the existence of rivalry almost surely produces inaccurate estimate.</p>
<section id="how-do-we-go-about-estimating-this" class="level3" data-number="11.1.1">
<h3 data-number="11.1.1" class="anchored" data-anchor-id="how-do-we-go-about-estimating-this"><span class="header-section-number">11.1.1</span> How do we go about estimating this?</h3>
<p>The technical details, followed by implementation.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/NRTELwU4EEc" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Selection equation- into grad school sample?</p>
<ul>
<li><span class="math inline">\(\zeta_i = z_i^T\gamma + \delta_i\)</span>
<ul>
<li><span class="math inline">\(\zeta_i\)</span> DV of selection equation</li>
<li><span class="math inline">\(z_i^T\)</span> vector of covariates for selection equation</li>
<li><span class="math inline">\(\gamma\)</span> vector of coefficients for selection equation</li>
<li><span class="math inline">\(\delta_i\)</span> random disturbances</li>
</ul></li>
</ul>
<p>Outcome equation</p>
<ul>
<li><span class="math inline">\(\xi_i = x_i^T\beta + \epsilon_i\)</span>
<ul>
<li><span class="math inline">\(\xi_i\)</span> DV of outcome equation (success in grad school)</li>
<li><span class="math inline">\(x_i^T\)</span> vector of covariates for outcome equation</li>
<li><span class="math inline">\(\beta\)</span> vector of coefficients for outcome equation</li>
<li><span class="math inline">\(\epsilon_i\)</span> random disturbances</li>
</ul></li>
</ul>
<p><strong><em>The Problem</em></strong></p>
<p>We actually want estimates of <span class="math inline">\(Y_i\)</span> not <span class="math inline">\(\xi_i\)</span>.</p>
<ul>
<li><span class="math inline">\(Y_i =\)</span></li>
</ul>
<span class="math display">\[\begin{cases} \text{missing }, \; \text{for } \zeta_i \leq 0\\ \xi_i,\;
\text{for } \zeta_i &gt; 0\end{cases}\]</span>
<p>Two-step Estimation</p>
<ul>
<li>Define a dichotomous outcome to indicate if in the sample or not <span class="math inline">\(W_i =\)</span></li>
</ul>
<span class="math display">\[\begin{cases} 1, \; \text{if } Y_i \text{ is observed } \\ 0, \; \text{ if } Y_i \text{ is missing } \end{cases}\]</span>
<ol type="1">
<li>Fit a probit regression with <span class="math inline">\(W_i\)</span> as the outcome with the linear predictor: <span class="math inline">\(\hat \psi_i = z_i^T\hat \gamma\)</span>
<ul>
<li>Calculate the “inverse Mills ratio” of <span class="math inline">\(\hat \eta_i = \frac{\phi(\hat \psi_i)}{\Phi(\hat \psi_i)}\)</span></li>
<li>Note this is <code>dnorm()/pnorm()</code>, ratio of the probability density function over the cumulative distribution function for each i</li>
</ul></li>
<li>Use <span class="math inline">\(\hat \eta_i\)</span> as an auxiliary regressor of <span class="math inline">\(Y_i\)</span> on the <span class="math inline">\(x_i^T\)</span> for those where <span class="math inline">\(Y_i\)</span> is observed.
<ul>
<li>Note the SEs have to be adjusted (not just the standard OLS errors).</li>
</ul></li>
</ol>
</section>
<section id="sample-selection-model-assumptions" class="level3" data-number="11.1.2">
<h3 data-number="11.1.2" class="anchored" data-anchor-id="sample-selection-model-assumptions"><span class="header-section-number">11.1.2</span> Sample Selection Model Assumptions</h3>
<p>Big assumptions</p>
<ul>
<li><strong><em>Exclusion restriction</em></strong> – selection equation should contain at least one variable that predicts selection but not the outcome</li>
<li>Errors in the probit equation are homoskedastic</li>
<li>Error terms for selection equation and outcome are correlated (<span class="math inline">\(\rho_{\epsilon \delta}\)</span>).
<ul>
<li><span class="math inline">\(\epsilon_i\)</span> and <span class="math inline">\(\delta_i\)</span> should be distributed as bivariate normal if using the MLE approach discussed below.</li>
</ul></li>
<li><span class="math inline">\(\epsilon_i\)</span> and <span class="math inline">\(\delta_i\)</span> should be independent of the regressors in their equations</li>
<li>Results can be sensitive to how you specify the selection equation</li>
</ul>
<p>A useful discussion in IR about these issues is Simmons and Hopkins (2005). An extension of this model has also been developed for models where the outcome is dichotomous (see: <a href="http://docs.zeligproject.org/articles/zeligchoice_bprobit.html">bivariate probit models</a>)</p>
</section>
</section>
<section id="fitting-sample-selection-in-r" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="fitting-sample-selection-in-r"><span class="header-section-number">11.2</span> Fitting Sample Selection in R</h2>
<p>We can use functions in R to do this calculation for us. We will follow the example from the <a href="https://rpubs.com/wsundstrom/t_selection">R Pubs resource</a>, which uses data from</p>
<ul>
<li>Mroz, T. A. (1987) “The sensitivity of an empirical model of married women’s hours of work to economic and statistical assumptions.” Econometrica 55, 765–799.</li>
</ul>
<p>Review the summary at the link above for information about the setup, where our outcome is married women’s wages, and the selection is labor force participation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages("sampleSelection")</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sampleSelection)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Mroz87"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The selection variable is <code>lfp</code>, a 0 or 1 variable indicating labor force participation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(Mroz87<span class="sc">$</span>lfp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1 
325 428 </code></pre>
</div>
</div>
<p>The sample selection issue is we do not observe wages for those out of the labor force. Thus, we can first estimate a model predicting labor force participation, and then a model predicting wages. We do so in the below code.</p>
<ul>
<li>Note, we need at least one variable in the selection equation that predicts selection but not wages. Here, we use <code>kids</code> for this.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Mroz87<span class="sc">$</span>kids <span class="ot">&lt;-</span> (Mroz87<span class="sc">$</span>kids5 <span class="sc">+</span> Mroz87<span class="sc">$</span>kids618)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We fit the model by providing two regression formulas in the <code>selection</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 2-step estimator</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>selection1 <span class="ot">&lt;-</span> <span class="fu">selection</span>(<span class="at">selection =</span> lfp <span class="sc">~</span> age  <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                          faminc <span class="sc">+</span> kids <span class="sc">+</span> educ,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">outcome =</span> wage <span class="sc">~</span> exper <span class="sc">+</span> age <span class="sc">+</span> educ <span class="sc">+</span> city, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> Mroz87,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">method =</span> <span class="st">"2step"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(selection1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--------------------------------------------
Tobit 2 model (sample selection model)
2-step Heckman / heckit estimation
753 observations (325 censored and 428 observed)
13 free parameters (df = 741)
Probit selection equation:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.377e-01  4.479e-01   0.307 0.758629    
age         -2.253e-02  6.898e-03  -3.266 0.001140 ** 
faminc       5.168e-06  4.150e-06   1.245 0.213428    
kids        -1.319e-01  3.768e-02  -3.500 0.000493 ***
educ         8.889e-02  2.285e-02   3.890 0.000109 ***
Outcome equation:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -1.45192    2.18010  -0.666 0.505627    
exper        0.01747    0.02167   0.806 0.420270    
age          0.01570    0.02524   0.622 0.534085    
educ         0.41456    0.11376   3.644 0.000287 ***
city         0.41415    0.31925   1.297 0.194947    
Multiple R-Squared:0.1261,  Adjusted R-Squared:0.1158
   Error terms:
              Estimate Std. Error t value Pr(&gt;|t|)
invMillsRatio  -1.1666     1.5530  -0.751    0.453
sigma           3.2149         NA      NA       NA
rho            -0.3629         NA      NA       NA
--------------------------------------------</code></pre>
</div>
</div>
<p>If the coefficient estimate on the inverse mills ratio is non-zero, that suggests that the selection probability does influence wages. We do not necessarily have strong evidence here given the high p-value. This may vary by how to specify the model. Note also that the estimate for this coefficient is the multiplication of sigma*rho, where rho is the correlation of the errors between equations and sigma is the standard error of the residuals from the regression equation.</p>
<p>Maximum likelihood also allows us to estimate the equations simultaneously. We just specify <code>ml</code> as the method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## alternative using maximum likelihood</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>selection2 <span class="ot">&lt;-</span> <span class="fu">selection</span>(<span class="at">selection =</span> lfp <span class="sc">~</span> age <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                          faminc <span class="sc">+</span> kids <span class="sc">+</span> educ,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">outcome =</span> wage <span class="sc">~</span> exper <span class="sc">+</span> age <span class="sc">+</span> educ <span class="sc">+</span> city, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> Mroz87,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">method =</span> <span class="st">"ml"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can see what is going on under the hood by fitting the 2-step process manually. The only difference is our manual standard errors would be wrong.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Selection equation</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>seleqn1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(lfp <span class="sc">~</span> age  <span class="sc">+</span> faminc <span class="sc">+</span> kids <span class="sc">+</span> educ,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"probit"</span>), <span class="at">data=</span>Mroz87)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate inverse Mills ratio by hand ##</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>Mroz87<span class="sc">$</span>IMR <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(seleqn1<span class="sc">$</span>linear.predictors)<span class="sc">/</span><span class="fu">pnorm</span>(seleqn1<span class="sc">$</span>linear.predictors)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Outcome equation correcting for selection </span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>outeqn1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(wage <span class="sc">~</span> exper <span class="sc">+</span> exper <span class="sc">+</span> age <span class="sc">+</span> educ <span class="sc">+</span> city<span class="sc">+</span>IMR , <span class="at">data=</span>Mroz87,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">subset=</span>(lfp<span class="sc">==</span><span class="dv">1</span>))</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Compare with the selection package results</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(outeqn1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)       exper         age        educ        city         IMR 
-1.45197781  0.01747395  0.01569873  0.41456568  0.41415262 -1.16657579 </code></pre>
</div>
</div>
<p>How should we interpret these results?</p>
<ul>
<li>If variables are only in the outcome equation, like city and experience, we can interpret them like OLS coefficients.</li>
<li>If variables appear in both equations, then we can also make an adjustment to have an estimate for the full average marginal effect, that also accounts for selection instead of just specifying the effect of the variable for those “that are selected”.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Example</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>selection3 <span class="ot">&lt;-</span> <span class="fu">selection</span>(<span class="at">selection =</span> lfp <span class="sc">~</span> age <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                          faminc <span class="sc">+</span> kids <span class="sc">+</span> educ,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">outcome =</span> wage <span class="sc">~</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                          exper <span class="sc">+</span> age <span class="sc">+</span> educ <span class="sc">+</span> city, <span class="at">data =</span> Mroz87,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">method =</span> <span class="st">"2step"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="do">## average marginal effect:</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>beta.educ.sel <span class="ot">&lt;-</span> selection3<span class="sc">$</span>coefficients[<span class="dv">5</span>]</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>beta.educ.out <span class="ot">&lt;-</span> selection3<span class="sc">$</span>coefficients[<span class="dv">9</span>]</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>beta.IMR <span class="ot">&lt;-</span> selection3<span class="sc">$</span>coefficients[<span class="dv">11</span>]</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> selection3<span class="sc">$</span>imrDelta</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>marginal.effect <span class="ot">&lt;-</span> beta.educ.out <span class="sc">-</span> (beta.educ.sel <span class="sc">*</span> beta.IMR <span class="sc">*</span> delta)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="do">## average marginal effect</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(marginal.effect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4757589</code></pre>
</div>
</div>
</section>
<section id="heckman-example-using-survey-data" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="heckman-example-using-survey-data"><span class="header-section-number">11.3</span> Heckman Example Using Survey Data</h2>
<p>This example is from “Poverty and Divine Rewards: The Electoral Advantage of Islamist Political Parties” published in the <em>American Journal of Political Science</em> in 2019.</p>
<p><em>Abstract</em> Political life in many Muslim-majority countries has been marked by the electoral dominance of Islamist parties. Recent attempts to explain why have highlighted their material and organizational factors, such as the provision of social services. In this article, we revive an older literature that emphasizes the appeal of these parties’ religious nature to voters experiencing economic hardship. Individuals suffering economic strain may vote for Islamists because they believe this to be an intrinsically virtuous act that will be met with divine rewards in the afterlife. We explore this hypothesis through a series of laboratory experiments in Tunisia. Individuals assigned to treatment conditions instilling feelings of economic strain exhibit greater support for Islamist parties, and this support is causally mediated by an expectation of divine compensation in the hereafter. The evidence suggests that the religious nature of Islamist parties may thus be an important factor in their electoral success.</p>
<p>We are going to replicate a small part of their analysis of an experiment:</p>
<ul>
<li>Experiment 2 induced economic strain by exposing participants (n = 201) to four hypothetical financial scenarios
<ul>
<li>Half were randomly assigned to a “hard” condition, in which the four scenarios involved financial costs that were relatively high, whereas</li>
<li>Half were assigned to an “easy” condition that involved substantially lower costs.</li>
</ul></li>
<li>One of the secondary dependent variables was: In Experiment 2, why they chose to vote for the party they did, giving them six options, including “Allah will be more pleased if I vote for this party than other parties.”
<ul>
<li>For each answer option, we asked respondents for their level of agreement with the statement and</li>
<li>subsequently asked them to rank each statement they agreed with in importance.</li>
</ul></li>
</ul>
<p>Let’s load the data and explore the variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>exp2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://github.com/ktmccabe/teachingdata/raw/main/exp2.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The authors are looking to verify that pleasing Allah had something to do with Ennahda vote choice, particularly among poor voters. Let’s look at the variable <code>votenahda</code>, which is a 0 or 1 outcome.</p>
<ul>
<li>1 if plan to vote for Ennahda if elections held tomorrow, 0 if not</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(exp2<span class="sc">$</span>votenahda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1 
335  66 </code></pre>
</div>
</div>
<p>Whether a voter is poor is determined by if they fall below 7 on the variable <code>inc</code>. Let’s subset our data to only examine poor voters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>subdata <span class="ot">&lt;-</span> <span class="fu">subset</span>(exp2, inc <span class="sc">&lt;</span> <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>They want to understand if pleasing Allah was a top reason for voting for the party. This information is only available for those that agreed or strongly agreed with the statement, “Allah will be more pleased if I vote for this party than other parties.”</p>
<p>This information is in the variable <code>voteAllah2</code></p>
<ul>
<li><code>voteAllah2</code>: 1=strongly agree or agree, 0=otherwise</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(exp2<span class="sc">$</span>voteAllah2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1 
118 169 </code></pre>
</div>
</div>
<p>The ranking information is available in the variable, <code>voteAllahrank3</code>:</p>
<ul>
<li><code>voteAllahrank3</code>: 1 if voteAllahrank <span class="math inline">\(&gt;\)</span> 4 (top two reasons); NA if voteAllahrank = 0; 0 otherwise.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(exp2<span class="sc">$</span>voteAllahrank3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1 
104  64 </code></pre>
</div>
</div>
<p>Let’s identify the sample selection issue.</p>
<ul>
<li><code>voteAllahrank3</code> is only observed for those who strongly agreed or agreed with the statement</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="at">RankedTopTwo=</span>exp2<span class="sc">$</span>voteAllahrank3, <span class="at">Agreed=</span>exp2<span class="sc">$</span>voteAllah2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Agreed
RankedTopTwo   0   1
           0   0 104
           1   0  64</code></pre>
</div>
</div>
<p>What makes this a candidate for a Heckman sample selection model?</p>
<details>
<summary>
Try on your own, then expand.
</summary>
<ul>
<li>We are interested in estimating whether Ennahda voters are more likely than others to rank pleasing Allah among the top two reasons. Our desired outcome is <span class="math inline">\(Y_i =\)</span> <code>voteAllahrank3</code>
<ul>
<li><span class="math inline">\(Y_i\)</span> only observed for those who met some criteria set by another random variable (in this case <code>voteAllah2</code> = 1).</li>
<li>However, we still have information on the independent variables for all respondents, regardless of whether they are a 0 or 1 on <code>voteAllah2</code></li>
</ul></li>
</ul>
</details>
<p>Estimate the two-step process, following the authors in terms of what variables to include in each stage according to columns 2 and 3 in the table.</p>
<p><img src="images/ajpsjamal.png" class="img-fluid" style="width:80.0%"></p>
<ul>
<li>Prior to fitting the model, subset the data to include only respondents who voted for <code>votenahda</code>, <code>votenidaa</code>, <code>votejabha</code>, <code>voteirada</code>, indicated by respondents being coded as a 1 on these variables. These correspond to the party variables in columns 2 and 3.
<ul>
<li>other relevant variables are <code>treat</code> and <code>quran</code></li>
</ul></li>
</ul>
<details>
<summary>
Try on your own, then expand for the solution.
</summary>
<p>As the authors note, “The ranking is a two-step process, as respondents only get to rank factors that they agree with. To model their rankings, we therefore employ a Heckman selection model, analyzing first who agreed that pleasing Allah is important in their vote choice, and then analyzing second who ranked pleasing Allah as one of their top two factors.”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>subdata2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(subdata, votenahda<span class="sc">==</span><span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                     votenidaa<span class="sc">==</span><span class="dv">1</span> <span class="sc">|</span> votejabha<span class="sc">==</span><span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                     voteirada<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>two <span class="ot">&lt;-</span> <span class="fu">selection</span>(<span class="at">selection =</span> voteAllah2<span class="sc">~</span>votenahda<span class="sc">+</span>votejabha<span class="sc">+</span>treat<span class="sc">+</span>quran, </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">outcome =</span> voteAllahrank3<span class="sc">~</span>votenahda<span class="sc">+</span>votenidaa, </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data=</span>subdata2, </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method=</span><span class="st">"2step"</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(two)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--------------------------------------------
Tobit 2 model (sample selection model)
2-step Heckman / heckit estimation
90 observations (31 censored and 59 observed)
11 free parameters (df = 80)
Probit selection equation:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)   0.3418     0.2897   1.180   0.2415  
votenahda     0.2442     0.3383   0.722   0.4725  
votejabha    -0.1369     0.3646  -0.375   0.7083  
treat        -0.4057     0.2906  -1.396   0.1665  
quran         0.6495     0.2927   2.219   0.0293 *
Outcome equation:
             Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) -0.007066   0.248585  -0.028   0.9774  
votenahda    0.312768   0.185545   1.686   0.0958 .
votenidaa    0.226522   0.161635   1.401   0.1650  
Multiple R-Squared:0.0558,  Adjusted R-Squared:0.0043
   Error terms:
              Estimate Std. Error t value Pr(&gt;|t|)
invMillsRatio   0.3248     0.3356   0.968    0.336
sigma           0.5187         NA      NA       NA
rho             0.6263         NA      NA       NA
--------------------------------------------</code></pre>
</div>
</div>
</details>
<p>How should we interpret the results in light of the researchers’ hypothesis that Ennahda voters would be more likely to rank pleasing Allah as a top reason?</p>
<details>
<summary>
Try on your own, then expand for the solution.
</summary>
<p>As the authors note describing the outcome equation, “results suggest that poor Ennahda voters were about 31% more likely to rank pleasing Allah among their top two factors (p = .096; see the SI, p.&nbsp;22) than poor supporters of secular parties.”</p>
<p>We have to be careful here, that this is from the outcome equation and does not represent the marginal effect based on both selection and outcome processes.</p>
</details>
</section>
<section id="tobit-model-aka-censored-regression-model" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="tobit-model-aka-censored-regression-model"><span class="header-section-number">11.4</span> Tobit Model aka Censored regression model</h2>
<p>Dealing with outcomes that are “top-coded” or “bottom-coded” at a threshold value</p>
<p><strong><em>Example: if income is top-coded as “above $250k”</em></strong></p>
<p><span class="math inline">\(Y_i\)</span> =</p>
<span class="math display">\[\begin{cases} Y_i^*, \; Y_i &lt; 250 \\ \text{ above 250 } \; Y_i \geq 250 \end{cases}\]</span>
<p>We are interested in <span class="math inline">\(Y_i^*\)</span>: actual income, not censored income. Problem- it’s unobserved for part of the sample</p>
<ul>
<li>Example: want to use SAT as measure of aptitude, but scores capped between 200 and 800</li>
<li>Example: want to measure support for candidate but legal maximum for campaign donations is $5000</li>
<li>Example: want to measure like-dislike of candy bars, but candy bars consumed bottom-coded at 0</li>
<li>Note: in classic tobit model, censoring happens at zero</li>
</ul>
<p>For elaboration in R, see this UCLA <a href="https://stats.idre.ucla.edu/r/dae/tobit-models/">resource</a> and <code>tobit()</code> in the AER package</p>
<section id="tobit-model-assumptions" class="level3" data-number="11.4.1">
<h3 data-number="11.4.1" class="anchored" data-anchor-id="tobit-model-assumptions"><span class="header-section-number">11.4.1</span> Tobit Model Assumptions</h3>
<ul>
<li>Assume homoskedastic and normally distributed errors</li>
<li>When data are censored at zero (clumping at zero), assume same underlying stochastic process to determine
<ul>
<li>whether the response is zero or positive</li>
<li>as well as the value of a positive response</li>
<li>Any variable which increases the probability of a non-zero value must also increase the mean of positive values.</li>
</ul></li>
<li>Should generally be used in cases where the dependent variable could take on negative values</li>
</ul>
<p>An alternative model discussed in the count data section: “two-part” and hurdle model–appropriate when the 0 is a “true zero”</p>
</section>
</section>
<section id="truncated-models" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="truncated-models"><span class="header-section-number">11.5</span> Truncated Models</h2>
<p>Sample selection is determined by values of the <span class="math inline">\(Y\)</span> variable. Do not observe x or y for truncated observations</p>
<ul>
<li>Example: interested in effect of education on income, but only sample people below a certain income.</li>
<li>Example: studies of electoral success of newly formed political parties. Problem: likely only observe new parties whn their chance of success is likely high</li>
<li>Example: studies using newspaper reports on social movements to study predictors of violence in these movements. Problem: newspapers select which movements to report on- likely those with chance of violence.</li>
</ul>
<p>Solution? Requires information about the mechanism that leads to the incomplete (or truncated) data set</p>
<ul>
<li><a href="https://stats.idre.ucla.edu/r/dae/truncated-regression/">See more on R implementation here</a></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./10-CountData.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Count data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./12-PanelData.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Panel and Hierarchical Data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>